"use strict";Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});const r=require("vue");var z=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function M(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function $e(e,t){var n=t.length,s=e.length;if(s>n)return!1;if(s===n)return e===t;e:for(var i=0,o=0;i<s;i++){for(var a=e.charCodeAt(i);o<n;)if(t.charCodeAt(o++)===a)continue e;return!1}return!0}var ke=$e;const ze=M(ke);function Fe(){}var We=Fe;const He=M(We),_=process.env.NODE_ENV==="production"?He:function(t,n){if(!t()){const s=["[Vue-Treeselect Warning]"].concat(n());console.error(...s)}};function L(e){return function(n,...s){n.type==="mousedown"&&n.button===0&&e.call(this,n,...s)}}function Pe(e,t){const n=e.getBoundingClientRect(),s=t.getBoundingClientRect(),i=t.offsetHeight/3;s.bottom+i>n.bottom?e.scrollTop=Math.min(t.offsetTop+t.clientHeight-e.offsetHeight+i,e.scrollHeight):s.top-i<n.top&&(e.scrollTop=Math.max(t.offsetTop-i,0))}function je(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}var be=je,Qe=typeof z=="object"&&z&&z.Object===Object&&z,Ke=Qe,Ue=Ke,qe=typeof self=="object"&&self&&self.Object===Object&&self,Ye=Ue||qe||Function("return this")(),ye=Ye,Xe=ye,Ge=function(){return Xe.Date.now()},Je=Ge,Ze=/\s/;function et(e){for(var t=e.length;t--&&Ze.test(e.charAt(t)););return t}var tt=et,nt=tt,st=/^\s+/;function it(e){return e&&e.slice(0,nt(e)+1).replace(st,"")}var rt=it,ot=ye,at=ot.Symbol,Ne=at,se=Ne,_e=Object.prototype,lt=_e.hasOwnProperty,ct=_e.toString,I=se?se.toStringTag:void 0;function ut(e){var t=lt.call(e,I),n=e[I];try{e[I]=void 0;var s=!0}catch{}var i=ct.call(e);return s&&(t?e[I]=n:delete e[I]),i}var dt=ut,ht=Object.prototype,ft=ht.toString;function pt(e){return ft.call(e)}var mt=pt,ie=Ne,gt=dt,vt=mt,St="[object Null]",Ot="[object Undefined]",re=ie?ie.toStringTag:void 0;function bt(e){return e==null?e===void 0?Ot:St:re&&re in Object(e)?gt(e):vt(e)}var yt=bt;function Nt(e){return e!=null&&typeof e=="object"}var _t=Nt,Et=yt,wt=_t,Ct="[object Symbol]";function Lt(e){return typeof e=="symbol"||wt(e)&&Et(e)==Ct}var Mt=Lt,Vt=rt,oe=be,Tt=Mt,ae=NaN,Dt=/^[-+]0x[0-9a-f]+$/i,It=/^0b[01]+$/i,xt=/^0o[0-7]+$/i,Rt=parseInt;function At(e){if(typeof e=="number")return e;if(Tt(e))return ae;if(oe(e)){var t=typeof e.valueOf=="function"?e.valueOf():e;e=oe(t)?t+"":t}if(typeof e!="string")return e===0?e:+e;e=Vt(e);var n=It.test(e);return n||xt.test(e)?Rt(e.slice(2),n?2:8):Dt.test(e)?ae:+e}var Ee=At,Bt=be,H=Je,le=Ee,$t="Expected a function",kt=Math.max,zt=Math.min;function Ft(e,t,n){var s,i,o,a,c,u,d=0,g=!1,f=!1,v=!0;if(typeof e!="function")throw new TypeError($t);t=le(t)||0,Bt(n)&&(g=!!n.leading,f="maxWait"in n,o=f?kt(le(n.maxWait)||0,t):o,v="trailing"in n?!!n.trailing:v);function w(p){var N=s,D=i;return s=i=void 0,d=p,a=e.apply(D,N),a}function T(p){return d=p,c=setTimeout(b,t),g?w(p):a}function B(p){var N=p-u,D=p-d,ne=t-N;return f?zt(ne,o-D):ne}function $(p){var N=p-u,D=p-d;return u===void 0||N>=t||N<0||f&&D>=o}function b(){var p=H();if($(p))return k(p);c=setTimeout(b,B(p))}function k(p){return c=void 0,v&&s?w(p):(s=i=void 0,a)}function l(){c!==void 0&&clearTimeout(c),d=0,s=u=i=c=void 0}function h(){return c===void 0?a:k(H())}function y(){var p=H(),N=$(p);if(s=arguments,i=this,u=p,N){if(c===void 0)return T(u);if(f)return clearTimeout(c),c=setTimeout(b,t),w(u)}return c===void 0&&(c=setTimeout(b,t)),a}return y.cancel=l,y.flush=h,y}var Wt=Ft;const Ht=M(Wt);var Pt=function(e,t){var n=document.createElement("_"),s=n.appendChild(document.createElement("_")),i=n.appendChild(document.createElement("_")),o=s.appendChild(document.createElement("_")),a=void 0,c=void 0;return s.style.cssText=n.style.cssText="height:100%;left:0;opacity:0;overflow:hidden;pointer-events:none;position:absolute;top:0;transition:0s;width:100%;z-index:-1",o.style.cssText=i.style.cssText="display:block;height:100%;transition:0s;width:100%",o.style.width=o.style.height="200%",e.appendChild(n),u(),g;function u(){d();var f=e.offsetWidth,v=e.offsetHeight;(f!==a||v!==c)&&(a=f,c=v,i.style.width=f*2+"px",i.style.height=v*2+"px",n.scrollLeft=n.scrollWidth,n.scrollTop=n.scrollHeight,s.scrollLeft=s.scrollWidth,s.scrollTop=s.scrollHeight,t({width:f,height:v})),s.addEventListener("scroll",u),n.addEventListener("scroll",u)}function d(){s.removeEventListener("scroll",u),n.removeEventListener("scroll",u)}function g(){d(),e.removeChild(n)}};function we(e,t){const n=e.indexOf(t);n!==-1&&e.splice(n,1)}let J;const W=[],jt=100;function Qt(){J=setInterval(()=>{W.forEach(Ce)},jt)}function Kt(){clearInterval(J),J=null}function Ce(e){const{$el:t,listener:n,lastWidth:s,lastHeight:i}=e,o=t.offsetWidth,a=t.offsetHeight;(s!==o||i!==a)&&(e.lastWidth=o,e.lastHeight=a,n({width:o,height:a}))}function Ut(e,t){const n={$el:e,listener:t,lastWidth:null,lastHeight:null},s=()=>{we(W,n),W.length||Kt()};return W.push(n),Ce(n),Qt(),s}function ce(e,t){const n=document.documentMode===9;let s=!0;const a=(n?Ut:Pt)(e,(...c)=>s||t(...c));return s=!1,a}function qt(e){const t=[];let n=e.parentNode;for(;n&&n.nodeName!=="BODY"&&n.nodeType===document.ELEMENT_NODE;)Yt(n)&&t.push(n),n=n.parentNode;return t.push(window),t}function Yt(e){const{overflow:t,overflowX:n,overflowY:s}=getComputedStyle(e);return/(auto|scroll|overlay)/.test(t+s+n)}function ue(e,t){const n=qt(e);return window.addEventListener("resize",t,{passive:!0}),n.forEach(s=>{s.addEventListener("scroll",t,{passive:!0})}),function(){window.removeEventListener("resize",t,{passive:!0}),n.forEach(i=>{i.removeEventListener("scroll",t,{passive:!0})})}}function Le(e){return e!==e}function Me(e){return!!e&&(typeof e=="object"||typeof e=="function")&&typeof e.then=="function"}var Xt=Ee,de=1/0,Gt=17976931348623157e292;function Jt(e){if(!e)return e===0?e:0;if(e=Xt(e),e===de||e===-de){var t=e<0?-1:1;return t*Gt}return e===e?e:0}var Zt=Jt,en=Zt;function tn(e){var t=en(e),n=t%1;return t===t?n?t-n:t:0}var nn=tn,sn=nn,rn="Expected a function";function on(e,t){var n;if(typeof t!="function")throw new TypeError(rn);return e=sn(e),function(){return--e>0&&(n=t.apply(this,arguments)),e<=1&&(t=void 0),n}}var an=on,ln=an;function cn(e){return ln(2,e)}var un=cn;const dn=M(un);function hn(e){return e}var fn=hn;const pn=M(fn);function mn(e){return function(){return e}}var gn=mn;const he=M(gn),S=()=>Object.create(null);function Ve(e){return e==null||typeof e!="object"?!1:Object.getPrototypeOf(e)===Object.prototype}function vn(e,t,n){Ve(n)?(e[t]||(e[t]={}),Z(e[t],n)):e[t]=n}function Z(e,t){if(Ve(t)){const n=Object.keys(t);for(let s=0,i=n.length;s<i;s++)vn(e,n[s],t[n[s]])}return e}function Sn(e){var t=e==null?0:e.length;return t?e[t-1]:void 0}var On=Sn;const fe=M(On);function E(e,t){return e.indexOf(t)!==-1}function bn(e,t,n){for(let s=0,i=e.length;s<i;s++)if(t.call(n,e[s],s,e))return e[s]}function P(e,t){if(e.length!==t.length)return!0;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!0;return!1}const C=null,ee=0,Te=1,De=2,V="ALL_CHILDREN",x="ALL_DESCENDANTS",R="LEAF_CHILDREN",A="LEAF_DESCENDANTS",yn="LOAD_ROOT_OPTIONS",Nn="LOAD_CHILDREN_OPTIONS",_n="ASYNC_SEARCH",j="ALL",F="BRANCH_PRIORITY",Q="LEAF_PRIORITY",K="ALL_WITH_INDETERMINATE",pe="ORDER_SELECTED",me="LEVEL",ge="INDEX",m={BACKSPACE:8,ENTER:13,ESCAPE:27,END:35,HOME:36,ARROW_LEFT:37,ARROW_UP:38,ARROW_RIGHT:39,ARROW_DOWN:40,DELETE:46},En=process.env.NODE_ENV==="testing"?10:200,ve=5,Se=40;function Ie(e,t){let n=0;do{if(e.level<n)return-1;if(t.level<n)return 1;if(e.index[n]!==t.index[n])return e.index[n]-t.index[n];n++}while(!0)}function wn(e,t){return e.level===t.level?Ie(e,t):e.level-t.level}function U(){return{isLoaded:!1,isLoading:!1,loadingError:""}}function Cn(e){return typeof e=="string"?e:typeof e=="number"&&!Le(e)?e+"":""}function Oe(e,t,n){return e?ze(t,n):E(n,t)}function q(e){return e.message||String(e)}let Ln=0;const Mn={provide(){return{instance:this}},props:{allowClearingDisabled:{type:Boolean,default:!1},allowSelectingDisabledDescendants:{type:Boolean,default:!1},alwaysOpen:{type:Boolean,default:!1},appendToBody:{type:Boolean,default:!1},async:{type:Boolean,default:!1},autoFocus:{type:Boolean,default:!1},autoLoadRootOptions:{type:Boolean,default:!0},autoDeselectAncestors:{type:Boolean,default:!1},autoDeselectDescendants:{type:Boolean,default:!1},autoSelectAncestors:{type:Boolean,default:!1},autoSelectDescendants:{type:Boolean,default:!1},backspaceRemoves:{type:Boolean,default:!0},beforeClearAll:{type:Function,default:he(!0)},branchNodesFirst:{type:Boolean,default:!1},cacheOptions:{type:Boolean,default:!0},clearable:{type:Boolean,default:!0},clearAllText:{type:String,default:"Clear all"},clearOnSelect:{type:Boolean,default:!1},clearValueText:{type:String,default:"Clear value"},closeOnSelect:{type:Boolean,default:!0},defaultExpandLevel:{type:Number,default:0},defaultOptions:{default:!1},deleteRemoves:{type:Boolean,default:!0},delimiter:{type:String,default:","},flattenSearchResults:{type:Boolean,default:!1},disableBranchNodes:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},disableFuzzyMatching:{type:Boolean,default:!1},flat:{type:Boolean,default:!1},instanceId:{default:()=>`${Ln++}$$`,type:[String,Number]},joinValues:{type:Boolean,default:!1},limit:{type:Number,default:1/0},limitText:{type:Function,default:function(t){return`and ${t} more`}},loadingText:{type:String,default:"Loading..."},loadOptions:{type:Function},matchKeys:{type:Array,default:he(["label"])},maxHeight:{type:Number,default:300},multiple:{type:Boolean,default:!1},name:{type:String},noChildrenText:{type:String,default:"No sub-options."},noOptionsText:{type:String,default:"No options available."},noResultsText:{type:String,default:"No results found..."},normalizer:{type:Function,default:pn},openDirection:{type:String,default:"auto",validator(e){return E(["auto","top","bottom","above","below"],e)}},openOnClick:{type:Boolean,default:!0},openOnFocus:{type:Boolean,default:!1},options:{type:Array},placeholder:{type:String,default:"Select..."},required:{type:Boolean,default:!1},retryText:{type:String,default:"Retry?"},retryTitle:{type:String,default:"Click to retry"},searchable:{type:Boolean,default:!0},searchNested:{type:Boolean,default:!1},searchPromptText:{type:String,default:"Type to search..."},showCount:{type:Boolean,default:!1},showCountOf:{type:String,default:V,validator(e){return E([V,x,R,A],e)}},showCountOnSearch:null,sortValueBy:{type:String,default:pe,validator(e){return E([pe,me,ge],e)}},tabIndex:{type:Number,default:0},modelValue:null,valueConsistsOf:{type:String,default:F,validator(e){return E([j,F,Q,K],e)}},valueFormat:{type:String,default:"id"},zIndex:{type:[Number,String],default:999}},data(){return{trigger:{isFocused:!1,searchQuery:""},menu:{isOpen:!1,current:null,lastScrollPosition:0,placement:"bottom"},forest:{normalizedOptions:[],nodeMap:S(),checkedStateMap:S(),selectedNodeIds:this.extractCheckedNodeIdsFromValue(),selectedNodeMap:S()},rootOptionsStates:U(),localSearch:{active:!1,noResults:!0,countMap:S()},remoteSearch:S()}},computed:{selectedNodes(){return this.forest.selectedNodeIds.map(this.getNode)},internalValue(){let e;if(this.single||this.flat||this.disableBranchNodes||this.valueConsistsOf===j)e=this.forest.selectedNodeIds.slice();else if(this.valueConsistsOf===F)e=this.forest.selectedNodeIds.filter(t=>{const n=this.getNode(t);return n.isRootNode?!0:!this.isSelected(n.parentNode)});else if(this.valueConsistsOf===Q)e=this.forest.selectedNodeIds.filter(t=>{const n=this.getNode(t);return n.isLeaf?!0:n.children.length===0});else if(this.valueConsistsOf===K){const t=[];e=this.forest.selectedNodeIds.slice(),this.selectedNodes.forEach(n=>{n.ancestors.forEach(s=>{E(t,s.id)||E(e,s.id)||t.push(s.id)})}),e.push(...t)}return this.sortValueBy===me?e.sort((t,n)=>wn(this.getNode(t),this.getNode(n))):this.sortValueBy===ge&&e.sort((t,n)=>Ie(this.getNode(t),this.getNode(n))),e},hasValue(){return this.internalValue.length>0},single(){return!this.multiple},visibleOptionIds(){const e=[];return this.traverseAllNodesByIndex(t=>{if((!this.localSearch.active||this.shouldOptionBeIncludedInSearchResult(t))&&e.push(t.id),t.isBranch&&!this.shouldExpand(t))return!1}),e},hasVisibleOptions(){return this.visibleOptionIds.length!==0},showCountOnSearchComputed(){return typeof this.showCountOnSearch=="boolean"?this.showCountOnSearch:this.showCount},hasBranchNodes(){return this.forest.normalizedOptions.some(e=>e.isBranch)},shouldFlattenOptions(){return this.localSearch.active&&this.flattenSearchResults}},watch:{alwaysOpen(e){e?this.openMenu():this.closeMenu()},branchNodesFirst(){this.initialize()},disabled(e){e&&this.menu.isOpen?this.closeMenu():!e&&!this.menu.isOpen&&this.alwaysOpen&&this.openMenu()},flat(){this.initialize()},internalValue(e,t){P(e,t)&&this.$emit("update:modelValue",this.getValue(),this.getInstanceId())},matchKeys(){this.initialize()},multiple(e){e&&this.buildForestState()},options:{handler(){this.async||(this.initialize(),this.rootOptionsStates.isLoaded=Array.isArray(this.options))},deep:!0,immediate:!0},"trigger.searchQuery"(){this.async?this.handleRemoteSearch():this.handleLocalSearch(),this.$emit("search-change",this.trigger.searchQuery,this.getInstanceId())},value(){const e=this.extractCheckedNodeIdsFromValue();P(e,this.internalValue)&&this.fixSelectedNodeIds(e)}},methods:{verifyProps(){_(()=>this.async?this.searchable:!0,()=>'For async search mode, the value of "searchable" prop must be true.'),this.options==null&&!this.loadOptions&&_(()=>!1,()=>'Are you meant to dynamically load options? You need to use "loadOptions" prop.'),this.flat&&_(()=>this.multiple,()=>'You are using flat mode. But you forgot to add "multiple=true"?'),this.flat||["autoSelectAncestors","autoSelectDescendants","autoDeselectAncestors","autoDeselectDescendants"].forEach(t=>{_(()=>!this[t],()=>`"${t}" only applies to flat mode.`)})},resetFlags(){this._blurOnSelect=!1},initialize(){const e=this.async?this.getRemoteSearchEntry().options:this.options;if(Array.isArray(e)){const t=this.forest.nodeMap;this.forest.nodeMap=S(),this.keepDataOfSelectedNodes(t),this.forest.normalizedOptions=this.normalize(C,e,t),this.fixSelectedNodeIds(this.internalValue)}else this.forest.normalizedOptions=[]},getInstanceId(){return this.instanceId==null?this.id:this.instanceId},getValue(){if(this.valueFormat==="id")return this.multiple?this.internalValue.slice():this.internalValue[0];const e=this.internalValue.map(t=>this.getNode(t).raw);return this.multiple?e:e[0]},getNode(e){return _(()=>e!=null,()=>`Invalid node id: ${e}`),e==null?null:e in this.forest.nodeMap?this.forest.nodeMap[e]:this.createFallbackNode(e)},createFallbackNode(e){const t=this.extractNodeFromValue(e),n=this.enhancedNormalizer(t).label||`${e} (unknown)`,s={id:e,label:n,ancestors:[],parentNode:C,isFallbackNode:!0,isRootNode:!0,isLeaf:!0,isBranch:!1,isDisabled:!1,isNew:!1,index:[-1],level:0,raw:t};return this.forest.nodeMap[e]=s},extractCheckedNodeIdsFromValue(){return this.modelValue==null?[]:this.valueFormat==="id"?this.multiple?this.modelValue.slice():[this.modelValue]:(this.multiple?this.modelValue:[this.modelValue]).map(e=>this.enhancedNormalizer(e)).map(e=>e.id)},extractNodeFromValue(e){const t={id:e};if(this.valueFormat==="id")return t;const n=this.multiple?Array.isArray(this.modelValue)?this.modelValue:[]:this.modelValue?[this.modelValue]:[];return bn(n,i=>i&&this.enhancedNormalizer(i).id===e)||t},fixSelectedNodeIds(e){let t=[];if(this.single||this.flat||this.disableBranchNodes||this.valueConsistsOf===j)t=e;else if(this.valueConsistsOf===F)e.forEach(s=>{t.push(s);const i=this.getNode(s);i.isBranch&&this.traverseDescendantsBFS(i,o=>{t.push(o.id)})});else if(this.valueConsistsOf===Q){const s=S(),i=e.slice();for(;i.length;){const o=i.shift(),a=this.getNode(o);t.push(o),!a.isRootNode&&(a.parentNode.id in s||(s[a.parentNode.id]=a.parentNode.children.length),--s[a.parentNode.id]===0&&i.push(a.parentNode.id))}}else if(this.valueConsistsOf===K){const s=S(),i=e.filter(o=>{const a=this.getNode(o);return a.isLeaf||a.children.length===0});for(;i.length;){const o=i.shift(),a=this.getNode(o);t.push(o),!a.isRootNode&&(a.parentNode.id in s||(s[a.parentNode.id]=a.parentNode.children.length),--s[a.parentNode.id]===0&&i.push(a.parentNode.id))}}P(this.forest.selectedNodeIds,t)&&(this.forest.selectedNodeIds=t),this.buildForestState()},keepDataOfSelectedNodes(e){this.forest.selectedNodeIds.forEach(t=>{if(!e[t])return;const n={...e[t],isFallbackNode:!0};this.forest.nodeMap[t]=n})},isSelected(e){return this.forest.selectedNodeMap[e.id]===!0},traverseDescendantsBFS(e,t){if(!e.isBranch)return;const n=e.children.slice();for(;n.length;){const s=n[0];s.isBranch&&n.push(...s.children),t(s),n.shift()}},traverseDescendantsDFS(e,t){e.isBranch&&e.children.forEach(n=>{this.traverseDescendantsDFS(n,t),t(n)})},traverseAllNodesDFS(e){this.forest.normalizedOptions.forEach(t=>{this.traverseDescendantsDFS(t,e),e(t)})},traverseAllNodesByIndex(e){const t=n=>{n.children.forEach(s=>{e(s)!==!1&&s.isBranch&&t(s)})};t({children:this.forest.normalizedOptions})},toggleClickOutsideEvent(e){e?document.addEventListener("mousedown",this.handleClickOutside,!1):document.removeEventListener("mousedown",this.handleClickOutside,!1)},getValueContainer(){return this.$refs.control.$refs["value-container"]},getInput(){return this.getValueContainer().$refs.input},focusInput(){this.getInput().focus()},blurInput(){this.getInput().blur()},handleMouseDown:L(function(t){if(t.preventDefault(),t.stopPropagation(),this.disabled)return;this.getValueContainer().$el.contains(t.target)&&!this.menu.isOpen&&(this.openOnClick||this.trigger.isFocused)&&this.openMenu(),this._blurOnSelect?this.blurInput():this.focusInput(),this.resetFlags()}),handleClickOutside(e){this.$refs.wrapper&&!this.$refs.wrapper.contains(e.target)&&(this.blurInput(),this.closeMenu())},handleLocalSearch(){const{searchQuery:e}=this.trigger,t=()=>this.resetHighlightedOptionWhenNecessary(!0);if(!e)return this.localSearch.active=!1,t();this.localSearch.active=!0,this.localSearch.noResults=!0,this.traverseAllNodesDFS(i=>{i.isBranch&&(i.isExpandedOnSearch=!1,i.showAllChildrenOnSearch=!1,i.isMatched=!1,i.hasMatchedDescendants=!1,this.localSearch.countMap[i.id]={[V]:0,[x]:0,[R]:0,[A]:0})});const n=e.trim().toLocaleLowerCase(),s=n.replace(/\s+/g," ").split(" ");this.traverseAllNodesDFS(i=>{this.searchNested&&s.length>1?i.isMatched=s.every(o=>Oe(!1,o,i.nestedSearchLabel)):i.isMatched=this.matchKeys.some(o=>Oe(!this.disableFuzzyMatching,n,i.lowerCased[o])),i.isMatched&&(this.localSearch.noResults=!1,i.ancestors.forEach(o=>this.localSearch.countMap[o.id][x]++),i.isLeaf&&i.ancestors.forEach(o=>this.localSearch.countMap[o.id][A]++),i.parentNode!==C&&(this.localSearch.countMap[i.parentNode.id][V]+=1,i.isLeaf&&(this.localSearch.countMap[i.parentNode.id][R]+=1))),(i.isMatched||i.isBranch&&i.isExpandedOnSearch)&&i.parentNode!==C&&(i.parentNode.isExpandedOnSearch=!0,i.parentNode.hasMatchedDescendants=!0)}),t()},handleRemoteSearch(){const{searchQuery:e}=this.trigger,t=this.getRemoteSearchEntry(),n=()=>{this.initialize(),this.resetHighlightedOptionWhenNecessary(!0)};if((e===""||this.cacheOptions)&&t.isLoaded)return n();this.callLoadOptionsProp({action:_n,args:{searchQuery:e},isPending(){return t.isLoading},start:()=>{t.isLoading=!0,t.isLoaded=!1,t.loadingError=""},succeed:s=>{t.isLoaded=!0,t.options=s,this.trigger.searchQuery===e&&n()},fail:s=>{t.loadingError=q(s)},end:()=>{t.isLoading=!1}})},getRemoteSearchEntry(){const{searchQuery:e}=this.trigger,t=this.remoteSearch[e]||{...U(),options:[]};if(this.$watch(()=>t.options,()=>{this.trigger.searchQuery===e&&this.initialize()},{deep:!0}),e===""){if(Array.isArray(this.defaultOptions))return t.options=this.defaultOptions,t.isLoaded=!0,t;if(this.defaultOptions!==!0)return t.isLoaded=!0,t}return this.remoteSearch[e]||(this.remoteSearch[e]=t),t},shouldExpand(e){return this.localSearch.active?e.isExpandedOnSearch:e.isExpanded},shouldOptionBeIncludedInSearchResult(e){return!!(e.isMatched||e.isBranch&&e.hasMatchedDescendants&&!this.flattenSearchResults||!e.isRootNode&&e.parentNode.showAllChildrenOnSearch)},shouldShowOptionInMenu(e){return!(this.localSearch.active&&!this.shouldOptionBeIncludedInSearchResult(e))},getControl(){var e;return(e=this.$refs.control)==null?void 0:e.$el},getMenu(){var t,n;const e=(n=(t=this.$refs.menu)==null?void 0:t.$refs)==null?void 0:n.menu;return e&&e.nodeName!=="#comment"?e:null},setCurrentHighlightedOption(e,t=!0){const n=this.menu.current;if(n!=null&&n in this.forest.nodeMap&&(this.forest.nodeMap[n].isHighlighted=!1),this.menu.current=e.id,e.isHighlighted=!0,this.menu.isOpen&&t){const s=()=>{const i=this.getMenu(),o=i.querySelector(`.vue-treeselect__option[data-id="${e.id}"]`);o&&Pe(i,o)};this.getMenu()?s():this.$nextTick(s)}},resetHighlightedOptionWhenNecessary(e=!1){const{current:t}=this.menu;(e||t==null||!(t in this.forest.nodeMap)||!this.shouldShowOptionInMenu(this.getNode(t)))&&this.highlightFirstOption()},highlightFirstOption(){if(!this.hasVisibleOptions)return;const e=this.visibleOptionIds[0];this.setCurrentHighlightedOption(this.getNode(e))},highlightPrevOption(){if(!this.hasVisibleOptions)return;const e=this.visibleOptionIds.indexOf(this.menu.current)-1;if(e===-1)return this.highlightLastOption();this.setCurrentHighlightedOption(this.getNode(this.visibleOptionIds[e]))},highlightNextOption(){if(!this.hasVisibleOptions)return;const e=this.visibleOptionIds.indexOf(this.menu.current)+1;if(e===this.visibleOptionIds.length)return this.highlightFirstOption();this.setCurrentHighlightedOption(this.getNode(this.visibleOptionIds[e]))},highlightLastOption(){if(!this.hasVisibleOptions)return;const e=fe(this.visibleOptionIds);this.setCurrentHighlightedOption(this.getNode(e))},resetSearchQuery(){this.trigger.searchQuery=""},closeMenu(){!this.menu.isOpen||!this.disabled&&this.alwaysOpen||(this.saveMenuScrollPosition(),this.menu.isOpen=!1,this.toggleClickOutsideEvent(!1),this.resetSearchQuery(),this.$emit("close",this.getValue(),this.getInstanceId()))},openMenu(){this.disabled||this.menu.isOpen||(this.menu.isOpen=!0,this.$nextTick(this.resetHighlightedOptionWhenNecessary),this.$nextTick(this.restoreMenuScrollPosition),!this.options&&!this.async&&this.loadRootOptions(),this.toggleClickOutsideEvent(!0),this.$emit("open",this.getInstanceId()))},toggleMenu(){this.menu.isOpen?this.closeMenu():this.openMenu()},toggleExpanded(e){let t;this.localSearch.active?(t=e.isExpandedOnSearch=!e.isExpandedOnSearch,t&&(e.showAllChildrenOnSearch=!0)):t=e.isExpanded=!e.isExpanded,t&&!e.childrenStates.isLoaded&&this.loadChildrenOptions(e)},buildForestState(){const e=S();this.forest.selectedNodeIds.forEach(n=>{e[n]=!0}),this.forest.selectedNodeMap=e;const t=S();this.multiple&&(this.traverseAllNodesByIndex(n=>{t[n.id]=ee}),this.selectedNodes.forEach(n=>{t[n.id]=De,!this.flat&&!this.disableBranchNodes&&n.ancestors.forEach(s=>{this.isSelected(s)||(t[s.id]=Te)})})),this.forest.checkedStateMap=t},enhancedNormalizer(e){return{...e,...this.normalizer(e,this.getInstanceId())}},normalize(e,t,n){let s=t.map(i=>[this.enhancedNormalizer(i),i]).map(([i,o],a)=>{this.checkDuplication(i),this.verifyNodeShape(i);const{id:c,label:u,children:d,isDefaultExpanded:g}=i,f=e===C,v=f?0:e.level+1,w=Array.isArray(d)||d===null,T=!w,B=!!i.isDisabled||!this.flat&&!f&&e.isDisabled,$=!!i.isNew,b=this.matchKeys.reduce((h,y)=>({...h,[y]:Cn(i[y]).toLocaleLowerCase()}),{}),k=f?b.label:e.nestedSearchLabel+" "+b.label;this.forest.nodeMap[c]=S();const l=this.forest.nodeMap[c];if(l.id=c,l.label=u,l.level=v,l.ancestors=f?[]:[e].concat(e.ancestors),l.index=(f?[]:e.index).concat(a),l.parentNode=e,l.lowerCased=b,l.nestedSearchLabel=k,l.isDisabled=B,l.isNew=$,l.isMatched=!1,l.isHighlighted=!1,l.isBranch=w,l.isLeaf=T,l.isRootNode=f,l.raw=o,w){const h=Array.isArray(d);l.childrenStates={...U(),isLoaded:h},l.isExpanded=typeof g=="boolean"?g:v<this.defaultExpandLevel,l.hasMatchedDescendants=!1,l.hasDisabledDescendants=!1,l.isExpandedOnSearch=!1,l.showAllChildrenOnSearch=!1,l.count={[V]:0,[x]:0,[R]:0,[A]:0},l.children=h?this.normalize(l,d,n):[],g===!0&&l.ancestors.forEach(y=>{y.isExpanded=!0}),!h&&typeof this.loadOptions!="function"?_(()=>!1,()=>'Unloaded branch node detected. "loadOptions" prop is required to load its children.'):!h&&l.isExpanded&&this.loadChildrenOptions(l)}if(l.ancestors.forEach(h=>h.count[x]++),T&&l.ancestors.forEach(h=>h.count[A]++),f||(e.count[V]+=1,T&&(e.count[R]+=1),B&&(e.hasDisabledDescendants=!0)),n&&n[c]){const h=n[c];l.isMatched=h.isMatched,l.showAllChildrenOnSearch=h.showAllChildrenOnSearch,l.isHighlighted=h.isHighlighted,h.isBranch&&l.isBranch&&(l.isExpanded=h.isExpanded,l.isExpandedOnSearch=h.isExpandedOnSearch,h.childrenStates.isLoaded&&!l.childrenStates.isLoaded?l.isExpanded=!1:l.childrenStates={...h.childrenStates})}return l});if(this.branchNodesFirst){const i=s.filter(a=>a.isBranch),o=s.filter(a=>a.isLeaf);s=i.concat(o)}return s},loadRootOptions(){this.callLoadOptionsProp({action:yn,isPending:()=>this.rootOptionsStates.isLoading,start:()=>{this.rootOptionsStates.isLoading=!0,this.rootOptionsStates.loadingError=""},succeed:()=>{this.rootOptionsStates.isLoaded=!0,this.$nextTick(()=>{this.resetHighlightedOptionWhenNecessary(!0)})},fail:e=>{this.rootOptionsStates.loadingError=q(e)},end:()=>{this.rootOptionsStates.isLoading=!1}})},loadChildrenOptions(e){const{id:t,raw:n}=e;this.callLoadOptionsProp({action:Nn,args:{parentNode:n},isPending:()=>this.getNode(t).childrenStates.isLoading,start:()=>{this.getNode(t).childrenStates.isLoading=!0,this.getNode(t).childrenStates.loadingError=""},succeed:()=>{this.getNode(t).childrenStates.isLoaded=!0},fail:s=>{this.getNode(t).childrenStates.loadingError=q(s)},end:()=>{this.getNode(t).childrenStates.isLoading=!1}})},callLoadOptionsProp({action:e,args:t,isPending:n,start:s,succeed:i,fail:o,end:a}){if(!this.loadOptions||n())return;s();const c=dn((d,g)=>{d?o(d):i(g),a()}),u=this.loadOptions({id:this.getInstanceId(),instanceId:this.getInstanceId(),action:e,...t,callback:c});Me(u)&&u.then(()=>{c()},d=>{c(d)}).catch(d=>{console.error(d)})},checkDuplication(e){_(()=>!(e.id in this.forest.nodeMap&&!this.forest.nodeMap[e.id].isFallbackNode),()=>`Detected duplicate presence of node id ${JSON.stringify(e.id)}. Their labels are "${this.forest.nodeMap[e.id].label}" and "${e.label}" respectively.`)},verifyNodeShape(e){_(()=>!(e.children===void 0&&e.isBranch===!0),()=>"Are you meant to declare an unloaded branch node? `isBranch: true` is no longer supported, please use `children: null` instead.")},select(e){if(this.disabled||e.isDisabled)return;this.single&&this.clear();const t=this.multiple&&!this.flat?this.forest.checkedStateMap[e.id]===ee:!this.isSelected(e);t?this._selectNode(e):this._deselectNode(e),this.buildForestState(),t?this.$emit("select",e.raw,this.getInstanceId()):this.$emit("deselect",e.raw,this.getInstanceId()),this.localSearch.active&&t&&(this.single||this.clearOnSelect)&&this.resetSearchQuery(),this.single&&this.closeOnSelect&&(this.closeMenu(),this.searchable&&(this._blurOnSelect=!0))},clear(){this.hasValue&&(this.single||this.allowClearingDisabled?this.forest.selectedNodeIds=[]:this.forest.selectedNodeIds=this.forest.selectedNodeIds.filter(e=>this.getNode(e).isDisabled),this.buildForestState())},_selectNode(e){if(this.single||this.disableBranchNodes)return this.addValue(e);if(this.flat){this.addValue(e),this.autoSelectAncestors?e.ancestors.forEach(n=>{!this.isSelected(n)&&!n.isDisabled&&this.addValue(n)}):this.autoSelectDescendants&&this.traverseDescendantsBFS(e,n=>{!this.isSelected(n)&&!n.isDisabled&&this.addValue(n)});return}const t=e.isLeaf||!e.hasDisabledDescendants||this.allowSelectingDisabledDescendants;if(t&&this.addValue(e),e.isBranch&&this.traverseDescendantsBFS(e,n=>{(!n.isDisabled||this.allowSelectingDisabledDescendants)&&this.addValue(n)}),t){let n=e;for(;(n=n.parentNode)!==C&&n.children.every(this.isSelected);)this.addValue(n)}},_deselectNode(e){if(this.disableBranchNodes)return this.removeValue(e);if(this.flat){this.removeValue(e),this.autoDeselectAncestors?e.ancestors.forEach(n=>{this.isSelected(n)&&!n.isDisabled&&this.removeValue(n)}):this.autoDeselectDescendants&&this.traverseDescendantsBFS(e,n=>{this.isSelected(n)&&!n.isDisabled&&this.removeValue(n)});return}let t=!1;if(e.isBranch&&this.traverseDescendantsDFS(e,n=>{(!n.isDisabled||this.allowSelectingDisabledDescendants)&&(this.removeValue(n),t=!0)}),e.isLeaf||t||e.children.length===0){this.removeValue(e);let n=e;for(;(n=n.parentNode)!==C&&this.isSelected(n);)this.removeValue(n)}},addValue(e){this.forest.selectedNodeIds.push(e.id),this.forest.selectedNodeMap[e.id]=!0},removeValue(e){we(this.forest.selectedNodeIds,e.id),delete this.forest.selectedNodeMap[e.id]},removeLastValue(){if(!this.hasValue)return;if(this.single)return this.clear();const e=fe(this.internalValue),t=this.getNode(e);this.select(t)},saveMenuScrollPosition(){const e=this.getMenu();e&&(this.menu.lastScrollPosition=e.scrollTop)},restoreMenuScrollPosition(){const e=this.getMenu();e&&(e.scrollTop=this.menu.lastScrollPosition)}},created(){this.verifyProps(),this.resetFlags()},mounted(){this.autoFocus&&this.focusInput(),!this.options&&!this.async&&this.autoLoadRootOptions&&this.loadRootOptions(),this.alwaysOpen&&this.openMenu(),this.async&&this.defaultOptions&&this.handleRemoteSearch()},unmounted(){this.toggleClickOutsideEvent(!1)}};function Vn(e){return typeof e=="string"?e:e!=null&&!Le(e)?JSON.stringify(e):""}const Tn={name:"vue-treeselect--hidden-fields",inject:["instance"],render(){const{instance:e}=this;if(!e||!("name"in e)||!e.name||e.disabled||!e.hasValue)return null;let t=e.internalValue.map(Vn);return e.multiple&&e.joinValues&&(t=[t.join(e.delimiter)]),t.map((n,s)=>r.createVNode("input",{type:"hidden",name:e.name,value:n,key:"hidden-field-"+s},null))}},Dn=[m.ENTER,m.END,m.HOME,m.ARROW_LEFT,m.ARROW_UP,m.ARROW_RIGHT,m.ARROW_DOWN],xe={name:"vue-treeselect--input",inject:["instance"],data:()=>({inputWidth:ve,value:""}),computed:{needAutoSize(){const{instance:e}=this;return e.searchable&&!e.disabled&&e.multiple},inputStyle(){return{width:this.needAutoSize?`${this.inputWidth}px`:null}}},watch:{"instance.trigger.searchQuery"(e){this.value=e},value(){this.needAutoSize&&this.$nextTick(this.updateInputWidth)}},created(){this.debouncedCallback=Ht(this.updateSearchQuery,En,{leading:!0,trailing:!0})},methods:{clear(){this.onInput({target:{value:""}})},focus(){const{instance:e}=this;e.disabled||this.$refs.input&&this.$refs.input.focus()},blur(){this.$refs.input&&this.$refs.input.blur()},onFocus(){const{instance:e}=this;e.trigger.isFocused=!0,e.openOnFocus&&e.openMenu()},onBlur(){const{instance:e}=this,t=e.getMenu();if(t&&document.activeElement===t)return this.focus();e.trigger.isFocused=!1,e.closeMenu()},onInput(e){const{value:t}=e.target;this.value=t,t?this.debouncedCallback():(this.debouncedCallback.cancel(),this.updateSearchQuery())},onKeyDown(e){const{instance:t}=this,n="which"in e?e.which:e.keyCode;if(!(e.ctrlKey||e.shiftKey||e.altKey||e.metaKey)){if(!t.menu.isOpen&&E(Dn,n))return e.preventDefault(),t.openMenu();switch(n){case m.BACKSPACE:{t.backspaceRemoves&&!this.value.length&&t.removeLastValue();break}case m.ENTER:{if(e.preventDefault(),t.menu.current===null)return;const s=t.getNode(t.menu.current);if(s.isBranch&&t.disableBranchNodes)return;t.select(s);break}case m.ESCAPE:{this.value.length?this.clear():t.menu.isOpen&&t.closeMenu();break}case m.END:{e.preventDefault(),t.highlightLastOption();break}case m.HOME:{e.preventDefault(),t.highlightFirstOption();break}case m.ARROW_LEFT:{const s=t.getNode(t.menu.current);s.isBranch&&t.shouldExpand(s)?(e.preventDefault(),t.toggleExpanded(s)):!s.isRootNode&&(s.isLeaf||s.isBranch&&!t.shouldExpand(s))&&(e.preventDefault(),t.setCurrentHighlightedOption(s.parentNode));break}case m.ARROW_UP:{e.preventDefault(),t.highlightPrevOption();break}case m.ARROW_RIGHT:{const s=t.getNode(t.menu.current);s.isBranch&&!t.shouldExpand(s)&&(e.preventDefault(),t.toggleExpanded(s));break}case m.ARROW_DOWN:{e.preventDefault(),t.highlightNextOption();break}case m.DELETE:{t.deleteRemoves&&!this.value.length&&t.removeLastValue();break}default:t.openMenu()}}},onMouseDown(e){this.value.length&&e.stopPropagation()},renderInputContainer(){const{instance:e}=this,t={},n=[];return e.searchable&&!e.disabled&&(n.push(this.renderInput()),this.needAutoSize&&n.push(this.renderSizer())),e.searchable||Z(t,{on:{focus:this.onFocus,blur:this.onBlur,keydown:this.onKeyDown},ref:"input"}),!e.searchable&&!e.disabled&&Z(t,{attrs:{tabIndex:e.tabIndex}}),r.createVNode("div",r.mergeProps({class:"vue-treeselect__input-container"},t),[n])},renderInput(){const{instance:e}=this;return r.createVNode("input",{ref:"input",class:"vue-treeselect__input",type:"text",autocomplete:"off",tabIndex:e.tabIndex,required:e.required&&!e.hasValue,value:this.value,style:this.inputStyle,onFocus:this.onFocus,onInput:this.onInput,onBlur:this.onBlur,onKeydown:this.onKeyDown,onMousedown:this.onMouseDown},null)},renderSizer(){return r.createVNode("div",{ref:"sizer",class:"vue-treeselect__sizer"},[this.value])},updateInputWidth(){this.inputWidth=Math.max(ve,this.$refs.sizer.scrollWidth+15)},updateSearchQuery(){const{instance:e}=this;e.trigger.searchQuery=this.value}},render(){return this.renderInputContainer()}},Re={name:"vue-treeselect--placeholder",inject:["instance"],render(){const{instance:e}=this,t={"vue-treeselect__placeholder":!0,"vue-treeselect-helper-zoom-effect-off":!0,"vue-treeselect-helper-hide":e.hasValue||e.trigger.searchQuery};return r.createVNode("div",{class:t},[e.placeholder])}},In={name:"vue-treeselect--single-value",inject:["instance"],methods:{renderSingleValueLabel(){const{instance:e}=this,t=e.selectedNodes[0],n=e.$slots["value-label"];return n?n({node:t}):t.label}},render(){const{instance:e,$parent:{renderValueContainer:t}}=this,n=e.hasValue&&!e.trigger.searchQuery;return t([n&&r.createVNode("div",{class:"vue-treeselect__single-value"},[this.renderSingleValueLabel()]),r.createVNode(Re,null,null),r.createVNode(xe,{ref:"input"},null)])}},te=(e,t)=>{const n=e.__vccOpts||e;for(const[s,i]of t)n[s]=i;return n},xn={name:"vue-treeselect--x"},Rn={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 348.333 348.333"},An=r.createElementVNode("path",{d:"M336.559 68.611L231.016 174.165l105.543 105.549c15.699 15.705 15.699 41.145 0 56.85-7.844 7.844-18.128 11.769-28.407 11.769-10.296 0-20.581-3.919-28.419-11.769L174.167 231.003 68.609 336.563c-7.843 7.844-18.128 11.769-28.416 11.769-10.285 0-20.563-3.919-28.413-11.769-15.699-15.698-15.699-41.139 0-56.85l105.54-105.549L11.774 68.611c-15.699-15.699-15.699-41.145 0-56.844 15.696-15.687 41.127-15.687 56.829 0l105.563 105.554L279.721 11.767c15.705-15.687 41.139-15.687 56.832 0 15.705 15.699 15.705 41.145.006 56.844z"},null,-1),Bn=[An];function $n(e,t,n,s,i,o){return r.openBlock(),r.createElementBlock("svg",Rn,Bn)}const Ae=te(xn,[["render",$n]]),kn={name:"vue-treeselect--multi-value-item",inject:["instance"],props:{node:{type:Object,required:!0}},methods:{handleMouseDown:L(function(){const{instance:t,node:n}=this;t.select(n)})},render(){const{instance:e,node:t}=this,n={"vue-treeselect__multi-value-item":!0,"vue-treeselect__multi-value-item-disabled":t.isDisabled,"vue-treeselect__multi-value-item-new":t.isNew},s=e.$slots["value-label"],i=s?s({node:t}):t.label;return r.createVNode("div",{class:"vue-treeselect__multi-value-item-container"},[r.createVNode("div",{class:n,onMousedown:this.handleMouseDown},[r.createVNode("span",{class:"vue-treeselect__multi-value-label"},[i]),r.createVNode("span",{class:"vue-treeselect__icon vue-treeselect__value-remove"},[r.createVNode(Ae,null,null)])])])}},zn={name:"vue-treeselect--multi-value",inject:["instance"],methods:{renderMultiValueItems(){const{instance:e}=this;return e.internalValue.slice(0,e.limit).map(e.getNode).map(t=>r.createVNode(kn,{key:`multi-value-item-${t.id}`,node:t},null))},renderExceedLimitTip(){const{instance:e}=this,t=e.internalValue.length-e.limit;return t<=0?null:r.createVNode("div",{class:"vue-treeselect__limit-tip vue-treeselect-helper-zoom-effect-off",key:"exceed-limit-tip"},[r.createVNode("span",{class:"vue-treeselect__limit-tip-text"},[e.limitText(t)])])}},render(){const{renderValueContainer:e}=this.$parent;return e(r.createVNode("div",{class:"vue-treeselect__multi-value",name:"vue-treeselect__multi-value-item--transition"},[this.renderMultiValueItems(),this.renderExceedLimitTip(),r.createVNode(Re,{key:"placeholder"},null),r.createVNode(xe,{ref:"input",key:"input"},null)]))}},Fn={name:"vue-treeselect--arrow"},Wn={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 292.362 292.362"},Hn=r.createElementVNode("path",{d:"M286.935 69.377c-3.614-3.617-7.898-5.424-12.848-5.424H18.274c-4.952 0-9.233 1.807-12.85 5.424C1.807 72.998 0 77.279 0 82.228c0 4.948 1.807 9.229 5.424 12.847l127.907 127.907c3.621 3.617 7.902 5.428 12.85 5.428s9.233-1.811 12.847-5.428L286.935 95.074c3.613-3.617 5.427-7.898 5.427-12.847 0-4.948-1.814-9.229-5.427-12.85z"},null,-1),Pn=[Hn];function jn(e,t,n,s,i,o){return r.openBlock(),r.createElementBlock("svg",Wn,Pn)}const Be=te(Fn,[["render",jn]]),Qn={name:"vue-treeselect--control",inject:["instance"],computed:{shouldShowX(){const{instance:e}=this;return e.clearable&&!e.disabled&&e.hasValue&&(this.hasUndisabledValue||e.allowClearingDisabled)},shouldShowArrow(){const{instance:e}=this;return e.alwaysOpen?!e.menu.isOpen:!0},hasUndisabledValue(){const{instance:e}=this;return e.hasValue&&e.internalValue.some(t=>!e.getNode(t).isDisabled)}},methods:{renderX(){const{instance:e}=this,t=e.multiple?e.clearAllText:e.clearValueText;return this.shouldShowX?r.createVNode("div",{class:"vue-treeselect__x-container",title:t,onMousedown:this.handleMouseDownOnX},[r.createVNode(Ae,{class:"vue-treeselect__x"},null)]):null},renderArrow(){const{instance:e}=this,t={"vue-treeselect__control-arrow":!0,"vue-treeselect__control-arrow--rotated":e.menu.isOpen};return this.shouldShowArrow?r.createVNode("div",{class:"vue-treeselect__control-arrow-container",onMousedown:this.handleMouseDownOnArrow},[r.createVNode(Be,{class:t},null)]):null},handleMouseDownOnX:L(function(t){t.stopPropagation(),t.preventDefault();const{instance:n}=this,s=n.beforeClearAll(),i=o=>{o&&n.clear()};Me(s)?s.then(i):setTimeout(()=>i(s),0)}),handleMouseDownOnArrow:L(function(t){t.preventDefault(),t.stopPropagation();const{instance:n}=this;n.focusInput(),n.toggleMenu()}),renderValueContainer(e){return r.createVNode("div",{class:"vue-treeselect__value-container"},[e])}},render(){const{instance:e}=this,t=e.single?In:zn;return r.createVNode("div",{class:"vue-treeselect__control",onMousedown:e.handleMouseDown},[r.createVNode(t,{ref:"value-container"},null),this.renderX(),this.renderArrow()])}},O={name:"vue-treeselect--tip",props:{type:{type:String,required:!0},icon:{type:String,required:!0}},render(){const{type:e,icon:t}=this;return r.createVNode("div",{class:`vue-treeselect__tip vue-treeselect__${e}-tip`},[r.createVNode("div",{class:"vue-treeselect__icon-container"},[r.createVNode("span",{class:`vue-treeselect__icon-${t}`},null)]),r.createVNode("span",{class:`vue-treeselect__tip-text vue-treeselect__${e}-tip-text`},[this.$slots.default()])])}};let Y,X,G;const Kn={name:"vue-treeselect--option",inject:["instance"],props:{node:{type:Object,required:!0}},computed:{shouldExpand(){const{instance:e,node:t}=this;return t.isBranch&&e.shouldExpand(t)},shouldShow(){const{instance:e,node:t}=this;return e.shouldShowOptionInMenu(t)}},methods:{renderOption(){const{instance:e,node:t}=this,n={"vue-treeselect__option":!0,"vue-treeselect__option--disabled":t.isDisabled,"vue-treeselect__option--selected":e.isSelected(t),"vue-treeselect__option--highlight":t.isHighlighted,"vue-treeselect__option--matched":e.localSearch.active&&t.isMatched,"vue-treeselect__option--hide":!this.shouldShow};return r.createVNode("div",{class:n,onMouseenter:this.handleMouseEnterOption,"data-id":t.id},[this.renderArrow(),this.renderLabelContainer([this.renderCheckboxContainer([this.renderCheckbox()]),this.renderLabel()])])},renderSubOptionsList(){return this.shouldExpand?r.createVNode("div",{class:"vue-treeselect__list"},[this.renderSubOptions(),this.renderNoChildrenTip(),this.renderLoadingChildrenTip(),this.renderLoadingChildrenErrorTip()]):null},renderArrow(){const{instance:e,node:t}=this;if(e.shouldFlattenOptions&&this.shouldShow)return null;if(t.isBranch){const n={"vue-treeselect__option-arrow":!0,"vue-treeselect__option-arrow--rotated":this.shouldExpand};return r.createVNode("div",{class:"vue-treeselect__option-arrow-container",onMousedown:this.handleMouseDownOnArrow},[r.createVNode("div",{name:"vue-treeselect__option-arrow--prepare"},[r.createVNode(Be,{class:n},null)])])}return e.hasBranchNodes?(Y||(Y=r.createVNode("div",{class:"vue-treeselect__option-arrow-placeholder"},[r.createTextVNode("Â ")])),Y):null},renderLabelContainer(e){return r.createVNode("div",{class:"vue-treeselect__label-container",onMousedown:this.handleMouseDownOnLabelContainer},[e])},renderCheckboxContainer(e){const{instance:t,node:n}=this;return t.single||t.disableBranchNodes&&n.isBranch?null:r.createVNode("div",{class:"vue-treeselect__checkbox-container"},[e])},renderCheckbox(){const{instance:e,node:t}=this,n=e.forest.checkedStateMap[t.id],s={"vue-treeselect__checkbox":!0,"vue-treeselect__checkbox--checked":n===De,"vue-treeselect__checkbox--indeterminate":n===Te,"vue-treeselect__checkbox--unchecked":n===ee,"vue-treeselect__checkbox--disabled":t.isDisabled};return X||(X=r.createVNode("span",{class:"vue-treeselect__check-mark"},null)),G||(G=r.createVNode("span",{class:"vue-treeselect__minus-mark"},null)),r.createVNode("span",{class:s},[X,G])},renderLabel(){const{instance:e,node:t}=this,n=t.isBranch&&(e.localSearch.active?e.showCountOnSearchComputed:e.showCount),s=n?e.localSearch.active?e.localSearch.countMap[t.id][e.showCountOf]:t.count[e.showCountOf]:NaN,i="vue-treeselect__label",o="vue-treeselect__count",a=e.$slots["option-label"];return a?a({node:t,shouldShowCount:n,count:s,labelClassName:i,countClassName:o}):r.createVNode("label",{class:i},[t.label,n&&r.createVNode("span",{class:o},[r.createTextVNode("("),s,r.createTextVNode(")")])])},renderSubOptions(){const{node:e}=this;return e.childrenStates.isLoaded?e.children.map(t=>r.createVNode(r.resolveComponent("vue-treeselect--option"),{node:t,key:t.id},null)):null},renderNoChildrenTip(){const{instance:e,node:t}=this;return!t.childrenStates.isLoaded||t.children.length?null:r.createVNode(O,{type:"no-children",icon:"warning"},{default:()=>[e.noChildrenText]})},renderLoadingChildrenTip(){const{instance:e,node:t}=this;return t.childrenStates.isLoading?r.createVNode(O,{type:"loading",icon:"loader"},{default:()=>[e.loadingText]}):null},renderLoadingChildrenErrorTip(){const{instance:e,node:t}=this;return t.childrenStates.loadingError?r.createVNode(O,{type:"error",icon:"error"},{default:()=>[t.childrenStates.loadingError,r.createVNode("a",{class:"vue-treeselect__retry",title:e.retryTitle,onMousedown:this.handleMouseDownOnRetry},[e.retryText])]}):null},handleMouseEnterOption(e){const{instance:t,node:n}=this;e.target===e.currentTarget&&t.setCurrentHighlightedOption(n,!1)},handleMouseDownOnArrow:L(function(){const{instance:t,node:n}=this;t.toggleExpanded(n)}),handleMouseDownOnLabelContainer:L(function(){const{instance:t,node:n}=this;n.isBranch&&t.disableBranchNodes?t.toggleExpanded(n):t.select(n)}),handleMouseDownOnRetry:L(function(){const{instance:t,node:n}=this;t.loadChildrenOptions(n)})},render(){const{node:e}=this,n={"vue-treeselect__list-item":!0,[`vue-treeselect__indent-level-${this.instance.shouldFlattenOptions?0:e.level}`]:!0};return r.createVNode("div",{class:n},[this.renderOption(),e.isBranch?r.createVNode("div",null,[this.renderSubOptionsList()]):""])}},Un={top:"top",bottom:"bottom",above:"top",below:"bottom"},qn={name:"vue-treeselect--menu",inject:["instance"],data(){return{controlResizeAndScrollEventListeners:null,controlSizeWatcher:null,menuSizeWatcher:null,menuResizeAndScrollEventListeners:null}},computed:{classes(){let e={"vue-treeselect__menu-container":!0};return this.instance.appendToBody&&(e["vue-treeselect__portal-target"]=!0),e},menuStyle(){const{instance:e}=this;return{maxHeight:e.maxHeight+"px"}},menuContainerStyle(){const{instance:e}=this;return{zIndex:e.appendToBody?null:e.zIndex}}},watch:{"instance.menu.placement"(){this.instance.appendToBody&&this.updateMenuContainerOffset()},"instance.menu.isOpen":{handler(e){e?(this.$nextTick(this.onMenuOpen),this.instance.appendToBody&&this.setupHandlers()):(this.onMenuClose(),this.instance.appendToBody&&this.removeHandlers())},immediate:!0}},created(){this.menuSizeWatcher=null,this.menuResizeAndScrollEventListeners=null},mounted(){},unmounted(){this.onMenuClose(),this.instance.appendToBody&&this.removeHandlers()},methods:{renderMenu(){const{instance:e}=this;return e.menu.isOpen?r.createVNode("div",{ref:"menu",class:"vue-treeselect__menu",onMousedown:e.handleMouseDown,style:this.menuStyle},[this.renderBeforeList(),e.async?this.renderAsyncSearchMenuInner():e.localSearch.active?this.renderLocalSearchMenuInner():this.renderNormalMenuInner(),this.renderAfterList()]):null},renderBeforeList(){const{instance:e}=this,t=e.$slots["before-list"];return t?t():null},renderAfterList(){const{instance:e}=this,t=e.$slots["after-list"];return t?t():null},renderNormalMenuInner(){const{instance:e}=this;return e.rootOptionsStates.isLoading?this.renderLoadingOptionsTip():e.rootOptionsStates.loadingError?this.renderLoadingRootOptionsErrorTip():e.rootOptionsStates.isLoaded&&e.forest.normalizedOptions.length===0?this.renderNoAvailableOptionsTip():this.renderOptionList()},renderLocalSearchMenuInner(){const{instance:e}=this;return e.rootOptionsStates.isLoading?this.renderLoadingOptionsTip():e.rootOptionsStates.loadingError?this.renderLoadingRootOptionsErrorTip():e.rootOptionsStates.isLoaded&&e.forest.normalizedOptions.length===0?this.renderNoAvailableOptionsTip():e.localSearch.noResults?this.renderNoResultsTip():this.renderOptionList()},renderAsyncSearchMenuInner(){const{instance:e}=this,t=e.getRemoteSearchEntry(),n=e.trigger.searchQuery===""&&!e.defaultOptions,s=n?!1:t.isLoaded&&t.options.length===0;return n?this.renderSearchPromptTip():t.isLoading?this.renderLoadingOptionsTip():t.loadingError?this.renderAsyncSearchLoadingErrorTip():s?this.renderNoResultsTip():this.renderOptionList()},renderOptionList(){const{instance:e}=this;return r.createVNode("div",{class:"vue-treeselect__list"},[e.forest.normalizedOptions.map(t=>r.createVNode(Kn,{node:t,key:t.id},null))])},renderSearchPromptTip(){const{instance:e}=this;return r.createVNode(O,{type:"search-prompt",icon:"warning"},{default:()=>[e.searchPromptText]})},renderLoadingOptionsTip(){const{instance:e}=this;return r.createVNode(O,{type:"loading",icon:"loader"},{default:()=>[e.loadingText]})},renderLoadingRootOptionsErrorTip(){const{instance:e}=this;return r.createVNode(O,{type:"error",icon:"error"},{default:()=>[e.rootOptionsStates.loadingError,r.createVNode("a",{class:"vue-treeselect__retry",onClick:e.loadRootOptions,title:e.retryTitle},[e.retryText])]})},renderAsyncSearchLoadingErrorTip(){const{instance:e}=this,t=e.getRemoteSearchEntry();return r.createVNode(O,{type:"error",icon:"error"},{default:()=>[t.loadingError,r.createVNode("a",{class:"vue-treeselect__retry",onClick:e.handleRemoteSearch,title:e.retryTitle},[e.retryText])]})},renderNoAvailableOptionsTip(){const{instance:e}=this;return r.createVNode(O,{type:"no-options",icon:"warning"},{default:()=>[e.noOptionsText]})},renderNoResultsTip(){const{instance:e}=this;return r.createVNode(O,{type:"no-results",icon:"warning"},{default:()=>[e.noResultsText]})},onMenuOpen(){this.adjustMenuOpenDirection(),this.setupMenuSizeWatcher(),this.setupMenuResizeAndScrollEventListeners(),this.instance.appendToBody&&this.updateMenuContainerOffset()},onMenuClose(){this.removeMenuSizeWatcher(),this.removeMenuResizeAndScrollEventListeners()},adjustMenuOpenDirection(){const{instance:e}=this;if(!e.menu.isOpen)return;const t=e.getMenu(),n=e.getControl(),s=t.getBoundingClientRect(),i=n.getBoundingClientRect(),o=s.height,a=window.innerHeight,c=i.top,u=window.innerHeight-i.bottom,d=i.top>=0&&i.top<=a||i.top<0&&i.bottom>0,g=u>o+Se,f=c>o+Se;d?e.openDirection!=="auto"?e.menu.placement=Un[e.openDirection]:g||!f?e.menu.placement="bottom":e.menu.placement="top":e.closeMenu()},setupMenuSizeWatcher(){const{instance:e}=this,t=e.getMenu();this.menuSizeWatcher||(this.menuSizeWatcher={remove:ce(t,this.adjustMenuOpenDirection)})},setupMenuResizeAndScrollEventListeners(){const{instance:e}=this,t=e.getControl();this.menuResizeAndScrollEventListeners||(this.menuResizeAndScrollEventListeners={remove:ue(t,this.adjustMenuOpenDirection)})},removeMenuSizeWatcher(){this.menuSizeWatcher&&(this.menuSizeWatcher.remove(),this.menuSizeWatcher=null)},removeMenuResizeAndScrollEventListeners(){this.menuResizeAndScrollEventListeners&&(this.menuResizeAndScrollEventListeners.remove(),this.menuResizeAndScrollEventListeners=null)},setupHandlers(){this.updateWidth(),this.updateMenuContainerOffset(),this.setupControlResizeAndScrollEventListeners(),this.setupControlSizeWatcher()},removeHandlers(){this.removeControlResizeAndScrollEventListeners(),this.removeControlSizeWatcher()},setupControlResizeAndScrollEventListeners(){const{instance:e}=this,t=e.getControl();this.controlResizeAndScrollEventListeners||(this.controlResizeAndScrollEventListeners={remove:ue(t,this.updateMenuContainerOffset)})},setupControlSizeWatcher(){const{instance:e}=this,t=e.getControl();this.controlSizeWatcher||(this.controlSizeWatcher={remove:ce(t,()=>{this.updateWidth(),this.updateMenuContainerOffset()})})},removeControlResizeAndScrollEventListeners(){this.controlResizeAndScrollEventListeners&&(this.controlResizeAndScrollEventListeners.remove(),this.controlResizeAndScrollEventListeners=null)},removeControlSizeWatcher(){this.controlSizeWatcher&&(this.controlSizeWatcher.remove(),this.controlSizeWatcher=null)},updateWidth(){const{instance:e}=this,t=this.$el,s=e.getControl().getBoundingClientRect();t&&(t.style.width=s.width+"px")},updateMenuContainerOffset(){const{instance:e}=this,t=e.getControl();if(t){const n=t.getBoundingClientRect(),s=Math.round(n.left)+"px",i=Math.round(n.bottom+window.scrollY)+"px",o=this.$refs["menu-container"].style;o.top=i,o.left=s}}},render(){return r.createVNode("div",{ref:"menu-container",class:this.classes,style:this.menuContainerStyle},[r.createVNode("div",{name:"vue-treeselect__menu--transition"},[this.renderMenu()])])}},Yn=r.defineComponent({name:"vue-treeselect",mixins:[Mn],components:{HiddenFields:Tn,Control:Qn,Menu:qn},computed:{wrapperClass(){return{"vue-treeselect":!0,"vue-treeselect--single":this.single,"vue-treeselect--multi":this.multiple,"vue-treeselect--searchable":this.searchable,"vue-treeselect--disabled":this.disabled,"vue-treeselect--focused":this.trigger.isFocused,"vue-treeselect--has-value":this.hasValue,"vue-treeselect--open":this.menu.isOpen,"vue-treeselect--open-above":this.menu.placement==="top","vue-treeselect--open-below":this.menu.placement==="bottom","vue-treeselect--branch-nodes-disabled":this.disableBranchNodes,"vue-treeselect--append-to-body":this.appendToBody}}}});function Xn(e,t,n,s,i,o){const a=r.resolveComponent("HiddenFields"),c=r.resolveComponent("Control"),u=r.resolveComponent("Menu");return r.openBlock(),r.createElementBlock("div",{ref:"wrapper",class:r.normalizeClass(e.wrapperClass)},[r.createVNode(a),r.createVNode(c,{ref:"control"},null,512),(r.openBlock(),r.createBlock(r.Teleport,{disabled:!e.appendToBody,to:"body"},[r.createVNode(u,{ref:"menu"},null,512)],8,["disabled"]))],2)}const Gn=te(Yn,[["render",Xn]]);exports.default=Gn;
