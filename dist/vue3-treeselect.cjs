"use strict";const i=require("vue");var k=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function L(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function $e(e,t){var s=t.length,n=e.length;if(n>s)return!1;if(n===s)return e===t;e:for(var r=0,o=0;r<n;r++){for(var l=e.charCodeAt(r);o<s;)if(t.charCodeAt(o++)===l)continue e;return!1}return!0}var ke=$e;const ze=L(ke);function Fe(){}var He=Fe;const We=L(He),N=process.env.NODE_ENV==="production"?We:function(t,s){if(!t()){const n=["[Vue-Treeselect Warning]"].concat(s());console.error(...n)}};function w(e){return function(s,...n){s.type==="mousedown"&&s.button===0&&e.call(this,s,...n)}}function Pe(e,t){const s=e.getBoundingClientRect(),n=t.getBoundingClientRect(),r=t.offsetHeight/3;n.bottom+r>s.bottom?e.scrollTop=Math.min(t.offsetTop+t.clientHeight-e.offsetHeight+r,e.scrollHeight):n.top-r<s.top&&(e.scrollTop=Math.max(t.offsetTop-r,0))}function je(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}var ye=je,Qe=typeof k=="object"&&k&&k.Object===Object&&k,Ue=Qe,Ke=Ue,qe=typeof self=="object"&&self&&self.Object===Object&&self,Ye=Ke||qe||Function("return this")(),Ne=Ye,Xe=Ne,Ge=function(){return Xe.Date.now()},Je=Ge,Ze=/\s/;function et(e){for(var t=e.length;t--&&Ze.test(e.charAt(t)););return t}var tt=et,st=tt,nt=/^\s+/;function it(e){return e&&e.slice(0,st(e)+1).replace(nt,"")}var rt=it,ot=Ne,lt=ot.Symbol,Oe=lt,ne=Oe,_e=Object.prototype,at=_e.hasOwnProperty,ct=_e.toString,M=ne?ne.toStringTag:void 0;function dt(e){var t=at.call(e,M),s=e[M];try{e[M]=void 0;var n=!0}catch{}var r=ct.call(e);return n&&(t?e[M]=s:delete e[M]),r}var ut=dt,ht=Object.prototype,pt=ht.toString;function ft(e){return pt.call(e)}var mt=ft,ie=Oe,gt=ut,vt=mt,St="[object Null]",bt="[object Undefined]",re=ie?ie.toStringTag:void 0;function yt(e){return e==null?e===void 0?bt:St:re&&re in Object(e)?gt(e):vt(e)}var Nt=yt;function Ot(e){return e!=null&&typeof e=="object"}var _t=Ot,Et=Nt,wt=_t,Lt="[object Symbol]";function Ct(e){return typeof e=="symbol"||wt(e)&&Et(e)==Lt}var Vt=Ct,Dt=rt,oe=ye,Tt=Vt,le=NaN,xt=/^[-+]0x[0-9a-f]+$/i,Mt=/^0b[01]+$/i,It=/^0o[0-7]+$/i,Rt=parseInt;function At(e){if(typeof e=="number")return e;if(Tt(e))return le;if(oe(e)){var t=typeof e.valueOf=="function"?e.valueOf():e;e=oe(t)?t+"":t}if(typeof e!="string")return e===0?e:+e;e=Dt(e);var s=Mt.test(e);return s||It.test(e)?Rt(e.slice(2),s?2:8):xt.test(e)?le:+e}var Ee=At,Bt=ye,P=Je,ae=Ee,$t="Expected a function",kt=Math.max,zt=Math.min;function Ft(e,t,s){var n,r,o,l,c,h,p=0,g=!1,f=!1,v=!0;if(typeof e!="function")throw new TypeError($t);t=ae(t)||0,Bt(s)&&(g=!!s.leading,f="maxWait"in s,o=f?kt(ae(s.maxWait)||0,t):o,v="trailing"in s?!!s.trailing:v);function _(d){var y=n,x=r;return n=r=void 0,p=d,l=e.apply(x,y),l}function T(d){return p=d,c=setTimeout(C,t),g?_(d):l}function B(d){var y=d-h,x=d-p,se=t-y;return f?zt(se,o-x):se}function $(d){var y=d-h,x=d-p;return h===void 0||y>=t||y<0||f&&x>=o}function C(){var d=P();if($(d))return V(d);c=setTimeout(C,B(d))}function V(d){return c=void 0,v&&n?_(d):(n=r=void 0,l)}function W(){c!==void 0&&clearTimeout(c),p=0,n=h=r=c=void 0}function a(){return c===void 0?l:V(P())}function u(){var d=P(),y=$(d);if(n=arguments,r=this,h=d,y){if(c===void 0)return T(h);if(f)return clearTimeout(c),c=setTimeout(C,t),_(h)}return c===void 0&&(c=setTimeout(C,t)),l}return u.cancel=W,u.flush=a,u}var Ht=Ft;const Wt=L(Ht);var Pt=function(e,t){var s=document.createElement("_"),n=s.appendChild(document.createElement("_")),r=s.appendChild(document.createElement("_")),o=n.appendChild(document.createElement("_")),l=void 0,c=void 0;return n.style.cssText=s.style.cssText="height:100%;left:0;opacity:0;overflow:hidden;pointer-events:none;position:absolute;top:0;transition:0s;width:100%;z-index:-1",o.style.cssText=r.style.cssText="display:block;height:100%;transition:0s;width:100%",o.style.width=o.style.height="200%",e.appendChild(s),h(),g;function h(){p();var f=e.offsetWidth,v=e.offsetHeight;(f!==l||v!==c)&&(l=f,c=v,r.style.width=f*2+"px",r.style.height=v*2+"px",s.scrollLeft=s.scrollWidth,s.scrollTop=s.scrollHeight,n.scrollLeft=n.scrollWidth,n.scrollTop=n.scrollHeight,t({width:f,height:v})),n.addEventListener("scroll",h),s.addEventListener("scroll",h)}function p(){n.removeEventListener("scroll",h),s.removeEventListener("scroll",h)}function g(){p(),e.removeChild(s)}};function we(e,t){const s=e.indexOf(t);s!==-1&&e.splice(s,1)}let Z;const F=[],jt=100;function Qt(){Z=setInterval(()=>{F.forEach(Le)},jt)}function Ut(){clearInterval(Z),Z=null}function Le(e){const{$el:t,listener:s,lastWidth:n,lastHeight:r}=e,o=t.offsetWidth,l=t.offsetHeight;(n!==o||r!==l)&&(e.lastWidth=o,e.lastHeight=l,s({width:o,height:l}))}function Kt(e,t){const s={$el:e,listener:t,lastWidth:null,lastHeight:null},n=()=>{we(F,s),F.length||Ut()};return F.push(s),Le(s),Qt(),n}function ce(e,t){const s=document.documentMode===9;let n=!0;const l=(s?Kt:Pt)(e,(...c)=>n||t(...c));return n=!1,l}function qt(e){const t=[];let s=e.parentNode;for(;s&&s.nodeName!=="BODY"&&s.nodeType===document.ELEMENT_NODE;)Yt(s)&&t.push(s),s=s.parentNode;return t.push(window),t}function Yt(e){const{overflow:t,overflowX:s,overflowY:n}=getComputedStyle(e);return/(auto|scroll|overlay)/.test(t+n+s)}function de(e,t){const s=qt(e);return window.addEventListener("resize",t,{passive:!0}),s.forEach(n=>{n.addEventListener("scroll",t,{passive:!0})}),function(){window.removeEventListener("resize",t,{passive:!0}),s.forEach(r=>{r.removeEventListener("scroll",t,{passive:!0})})}}function Ce(e){return e!==e}function Ve(e){return!!e&&(typeof e=="object"||typeof e=="function")&&typeof e.then=="function"}var Xt=Ee,ue=1/0,Gt=17976931348623157e292;function Jt(e){if(!e)return e===0?e:0;if(e=Xt(e),e===ue||e===-ue){var t=e<0?-1:1;return t*Gt}return e===e?e:0}var Zt=Jt,es=Zt;function ts(e){var t=es(e),s=t%1;return t===t?s?t-s:t:0}var ss=ts,ns=ss,is="Expected a function";function rs(e,t){var s;if(typeof t!="function")throw new TypeError(is);return e=ns(e),function(){return--e>0&&(s=t.apply(this,arguments)),e<=1&&(t=void 0),s}}var os=rs,ls=os;function as(e){return ls(2,e)}var cs=as;const ds=L(cs);function us(e){return e}var hs=us;const ps=L(hs);function fs(e){return function(){return e}}var ms=fs;const he=L(ms),S=()=>Object.create(null);function De(e){return e==null||typeof e!="object"?!1:Object.getPrototypeOf(e)===Object.prototype}function gs(e,t,s){De(s)?(e[t]||(e[t]={}),ee(e[t],s)):e[t]=s}function ee(e,t){if(De(t)){const s=Object.keys(t);for(let n=0,r=s.length;n<r;n++)gs(e,s[n],t[s[n]])}return e}function vs(e){var t=e==null?0:e.length;return t?e[t-1]:void 0}var Ss=vs;const pe=L(Ss);function O(e,t){return e.indexOf(t)!==-1}function bs(e,t,s){for(let n=0,r=e.length;n<r;n++)if(t.call(s,e[n],n,e))return e[n]}function j(e,t){if(e.length!==t.length)return!0;for(let s=0;s<e.length;s++)if(e[s]!==t[s])return!0;return!1}const E=null,te=0,Te=1,xe=2,D="ALL_CHILDREN",I="ALL_DESCENDANTS",R="LEAF_CHILDREN",A="LEAF_DESCENDANTS",ys="LOAD_ROOT_OPTIONS",Ns="LOAD_CHILDREN_OPTIONS",Os="ASYNC_SEARCH",Q="ALL",z="BRANCH_PRIORITY",U="LEAF_PRIORITY",K="ALL_WITH_INDETERMINATE",fe="ORDER_SELECTED",me="LEVEL",ge="INDEX",m={BACKSPACE:8,ENTER:13,ESCAPE:27,END:35,HOME:36,ARROW_LEFT:37,ARROW_UP:38,ARROW_RIGHT:39,ARROW_DOWN:40,DELETE:46},_s=process.env.NODE_ENV==="testing"?10:200,ve=5,Se=40;function Me(e,t){let s=0;do{if(e.level<s)return-1;if(t.level<s)return 1;if(e.index[s]!==t.index[s])return e.index[s]-t.index[s];s++}while(!0)}function Es(e,t){return e.level===t.level?Me(e,t):e.level-t.level}function q(){return{isLoaded:!1,isLoading:!1,loadingError:""}}function ws(e){return typeof e=="string"?e:typeof e=="number"&&!Ce(e)?e+"":""}function be(e,t,s){return e?ze(t,s):O(s,t)}function Y(e){return e.message||String(e)}let Ls=0;const Cs={provide(){return{instance:this}},props:{allowClearingDisabled:{type:Boolean,default:!1},allowSelectingDisabledDescendants:{type:Boolean,default:!1},alwaysOpen:{type:Boolean,default:!1},appendToBody:{type:Boolean,default:!1},async:{type:Boolean,default:!1},autoFocus:{type:Boolean,default:!1},autoLoadRootOptions:{type:Boolean,default:!0},autoDeselectAncestors:{type:Boolean,default:!1},autoDeselectDescendants:{type:Boolean,default:!1},autoSelectAncestors:{type:Boolean,default:!1},autoSelectDescendants:{type:Boolean,default:!1},backspaceRemoves:{type:Boolean,default:!0},beforeClearAll:{type:Function,default:he(!0)},branchNodesFirst:{type:Boolean,default:!1},cacheOptions:{type:Boolean,default:!0},clearable:{type:Boolean,default:!0},clearAllText:{type:String,default:"Clear all"},clearOnSelect:{type:Boolean,default:!1},clearValueText:{type:String,default:"Clear value"},closeOnSelect:{type:Boolean,default:!0},defaultExpandLevel:{type:Number,default:0},defaultOptions:{default:!1},deleteRemoves:{type:Boolean,default:!0},delimiter:{type:String,default:","},flattenSearchResults:{type:Boolean,default:!1},disableBranchNodes:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},disableFuzzyMatching:{type:Boolean,default:!1},flat:{type:Boolean,default:!1},instanceId:{default:()=>`${Ls++}$$`,type:[String,Number]},joinValues:{type:Boolean,default:!1},limit:{type:Number,default:1/0},limitText:{type:Function,default:function(t){return`and ${t} more`}},loadingText:{type:String,default:"Loading..."},loadOptions:{type:Function},matchKeys:{type:Array,default:he(["label"])},maxHeight:{type:Number,default:300},multiple:{type:Boolean,default:!1},name:{type:String},noChildrenText:{type:String,default:"No sub-options."},noOptionsText:{type:String,default:"No options available."},noResultsText:{type:String,default:"No results found..."},normalizer:{type:Function,default:ps},openDirection:{type:String,default:"auto",validator(e){return O(["auto","top","bottom","above","below"],e)}},openOnClick:{type:Boolean,default:!0},openOnFocus:{type:Boolean,default:!1},options:{type:Array},placeholder:{type:String,default:"Select..."},required:{type:Boolean,default:!1},retryText:{type:String,default:"Retry?"},retryTitle:{type:String,default:"Click to retry"},searchable:{type:Boolean,default:!0},searchNested:{type:Boolean,default:!1},searchPromptText:{type:String,default:"Type to search..."},showCount:{type:Boolean,default:!1},showCountOf:{type:String,default:D,validator(e){return O([D,I,R,A],e)}},showCountOnSearch:null,sortValueBy:{type:String,default:fe,validator(e){return O([fe,me,ge],e)}},tabIndex:{type:Number,default:0},modelValue:null,valueConsistsOf:{type:String,default:z,validator(e){return O([Q,z,U,K],e)}},valueFormat:{type:String,default:"id"},zIndex:{type:[Number,String],default:999}},data(){return{trigger:{isFocused:!1,searchQuery:""},menu:{isOpen:!1,current:null,lastScrollPosition:0,placement:"bottom"},forest:{normalizedOptions:[],nodeMap:S(),checkedStateMap:S(),selectedNodeIds:this.extractCheckedNodeIdsFromValue(),selectedNodeMap:S()},rootOptionsStates:q(),localSearch:{active:!1,noResults:!0,countMap:S()},remoteSearch:S()}},computed:{selectedNodes(){return this.forest.selectedNodeIds.map(this.getNode)},internalValue(){let e;if(this.single||this.flat||this.disableBranchNodes||this.valueConsistsOf===Q)e=this.forest.selectedNodeIds.slice();else if(this.valueConsistsOf===z)e=this.forest.selectedNodeIds.filter(t=>{const s=this.getNode(t);return s.isRootNode?!0:!this.isSelected(s.parentNode)});else if(this.valueConsistsOf===U)e=this.forest.selectedNodeIds.filter(t=>{const s=this.getNode(t);return s.isLeaf?!0:s.children.length===0});else if(this.valueConsistsOf===K){const t=[];e=this.forest.selectedNodeIds.slice(),this.selectedNodes.forEach(s=>{s.ancestors.forEach(n=>{O(t,n.id)||O(e,n.id)||t.push(n.id)})}),e.push(...t)}return this.sortValueBy===me?e.sort((t,s)=>Es(this.getNode(t),this.getNode(s))):this.sortValueBy===ge&&e.sort((t,s)=>Me(this.getNode(t),this.getNode(s))),e},hasValue(){return this.internalValue.length>0},single(){return!this.multiple},visibleOptionIds(){const e=[];return this.traverseAllNodesByIndex(t=>{if((!this.localSearch.active||this.shouldOptionBeIncludedInSearchResult(t))&&e.push(t.id),t.isBranch&&!this.shouldExpand(t))return!1}),e},hasVisibleOptions(){return this.visibleOptionIds.length!==0},showCountOnSearchComputed(){return typeof this.showCountOnSearch=="boolean"?this.showCountOnSearch:this.showCount},hasBranchNodes(){return this.forest.normalizedOptions.some(e=>e.isBranch)},shouldFlattenOptions(){return this.localSearch.active&&this.flattenSearchResults}},watch:{alwaysOpen(e){e?this.openMenu():this.closeMenu()},branchNodesFirst(){this.initialize()},disabled(e){e&&this.menu.isOpen?this.closeMenu():!e&&!this.menu.isOpen&&this.alwaysOpen&&this.openMenu()},flat(){this.initialize()},internalValue(e,t){j(e,t)&&this.$emit("update:modelValue",this.getValue(),this.getInstanceId())},matchKeys(){this.initialize()},multiple(e){e&&this.buildForestState()},options:{handler(){this.async||(this.initialize(),this.rootOptionsStates.isLoaded=Array.isArray(this.options))},deep:!0,immediate:!0},"trigger.searchQuery"(){this.async?this.handleRemoteSearch():this.handleLocalSearch(),this.$emit("search-change",this.trigger.searchQuery,this.getInstanceId())},modelValue(){const e=this.extractCheckedNodeIdsFromValue();j(e,this.internalValue)&&this.fixSelectedNodeIds(e)}},methods:{verifyProps(){N(()=>this.async?this.searchable:!0,()=>'For async search mode, the value of "searchable" prop must be true.'),this.options==null&&!this.loadOptions&&N(()=>!1,()=>'Are you meant to dynamically load options? You need to use "loadOptions" prop.'),this.flat&&N(()=>this.multiple,()=>'You are using flat mode. But you forgot to add "multiple=true"?'),this.flat||["autoSelectAncestors","autoSelectDescendants","autoDeselectAncestors","autoDeselectDescendants"].forEach(t=>{N(()=>!this[t],()=>`"${t}" only applies to flat mode.`)})},resetFlags(){this._blurOnSelect=!1},initialize(){const e=this.async?this.getRemoteSearchEntry().options:this.options;if(Array.isArray(e)){const t=this.forest.nodeMap;this.forest.nodeMap=S(),this.keepDataOfSelectedNodes(t),this.forest.normalizedOptions=this.normalize(E,e,t),this.fixSelectedNodeIds(this.internalValue)}else this.forest.normalizedOptions=[]},getInstanceId(){return this.instanceId==null?this.id:this.instanceId},getValue(){if(this.valueFormat==="id")return this.multiple?this.internalValue.slice():this.internalValue[0];const e=this.internalValue.map(t=>this.getNode(t).raw);return this.multiple?e:e[0]},getNode(e){return N(()=>e!=null,()=>`Invalid node id: ${e}`),e==null?null:e in this.forest.nodeMap?this.forest.nodeMap[e]:this.createFallbackNode(e)},createFallbackNode(e){const t=this.extractNodeFromValue(e),s=this.enhancedNormalizer(t).label||`${e} (unknown)`,n={id:e,label:s,ancestors:[],parentNode:E,isFallbackNode:!0,isRootNode:!0,isLeaf:!0,isBranch:!1,isDisabled:!1,isSelfDisabled:!1,isNew:!1,index:[-1],level:0,raw:t};return this.forest.nodeMap[e]=n},extractCheckedNodeIdsFromValue(){return this.modelValue==null?[]:this.valueFormat==="id"?this.multiple?this.modelValue.slice():[this.modelValue]:(this.multiple?this.modelValue:[this.modelValue]).map(e=>this.enhancedNormalizer(e)).map(e=>e.id)},extractNodeFromValue(e){const t={id:e};if(this.valueFormat==="id")return t;const s=this.multiple?Array.isArray(this.modelValue)?this.modelValue:[]:this.modelValue?[this.modelValue]:[];return bs(s,r=>r&&this.enhancedNormalizer(r).id===e)||t},fixSelectedNodeIds(e){let t=[];if(this.single||this.flat||this.disableBranchNodes||this.valueConsistsOf===Q)t=e;else if(this.valueConsistsOf===z)e.forEach(n=>{t.push(n);const r=this.getNode(n);r.isBranch&&this.traverseDescendantsBFS(r,o=>{t.push(o.id)})});else if(this.valueConsistsOf===U){const n=S(),r=e.slice();for(;r.length;){const o=r.shift(),l=this.getNode(o);t.push(o),!l.isRootNode&&(l.parentNode.id in n||(n[l.parentNode.id]=l.parentNode.children.length),--n[l.parentNode.id]===0&&r.push(l.parentNode.id))}}else if(this.valueConsistsOf===K){const n=S(),r=e.filter(o=>{const l=this.getNode(o);return l.isLeaf||l.children.length===0});for(;r.length;){const o=r.shift(),l=this.getNode(o);t.push(o),!l.isRootNode&&(l.parentNode.id in n||(n[l.parentNode.id]=l.parentNode.children.length),--n[l.parentNode.id]===0&&r.push(l.parentNode.id))}}j(this.forest.selectedNodeIds,t)&&(this.forest.selectedNodeIds=t),this.buildForestState()},keepDataOfSelectedNodes(e){this.forest.selectedNodeIds.forEach(t=>{if(!e[t])return;const s={...e[t],isFallbackNode:!0};this.forest.nodeMap[t]=s})},isSelected(e){return this.forest.selectedNodeMap[e.id]===!0},traverseDescendantsBFS(e,t){if(!e.isBranch)return;const s=e.children.slice();for(;s.length;){const n=s[0];n.isBranch&&s.push(...n.children),t(n),s.shift()}},traverseDescendantsDFS(e,t){e.isBranch&&e.children.forEach(s=>{this.traverseDescendantsDFS(s,t),t(s)})},traverseAllNodesDFS(e){this.forest.normalizedOptions.forEach(t=>{this.traverseDescendantsDFS(t,e),e(t)})},traverseAllNodesByIndex(e){const t=s=>{s.children.forEach(n=>{e(n)!==!1&&n.isBranch&&t(n)})};t({children:this.forest.normalizedOptions})},toggleClickOutsideEvent(e){e?document.addEventListener("mousedown",this.handleClickOutside,!1):document.removeEventListener("mousedown",this.handleClickOutside,!1)},getValueContainer(){return this.$refs.control.$refs["value-container"]},getInput(){return this.getValueContainer().$refs.input},focusInput(){this.getInput().focus()},blurInput(){this.getInput().blur()},handleMouseDown:w(function(t){if(t.preventDefault(),t.stopPropagation(),this.disabled)return;this.getValueContainer().$el.contains(t.target)&&!this.menu.isOpen&&(this.openOnClick||this.trigger.isFocused)&&this.openMenu(),this._blurOnSelect?this.blurInput():this.focusInput(),this.resetFlags()}),handleClickOutside(e){this.$refs.wrapper&&!this.$refs.wrapper.contains(e.target)&&(this.blurInput(),this.closeMenu())},handleLocalSearch(){const{searchQuery:e}=this.trigger,t=()=>this.resetHighlightedOptionWhenNecessary(!0);if(!e)return this.localSearch.active=!1,t();this.localSearch.active=!0,this.localSearch.noResults=!0,this.traverseAllNodesDFS(r=>{r.isBranch&&(r.isExpandedOnSearch=!1,r.showAllChildrenOnSearch=!1,r.isMatched=!1,r.hasMatchedDescendants=!1,this.localSearch.countMap[r.id]={[D]:0,[I]:0,[R]:0,[A]:0})});const s=e.trim().toLocaleLowerCase(),n=s.replace(/\s+/g," ").split(" ");this.traverseAllNodesDFS(r=>{this.searchNested&&n.length>1?r.isMatched=n.every(o=>be(!1,o,r.nestedSearchLabel)):r.isMatched=this.matchKeys.some(o=>be(!this.disableFuzzyMatching,s,r.lowerCased[o])),r.isMatched&&(this.localSearch.noResults=!1,r.ancestors.forEach(o=>this.localSearch.countMap[o.id][I]++),r.isLeaf&&r.ancestors.forEach(o=>this.localSearch.countMap[o.id][A]++),r.parentNode!==E&&(this.localSearch.countMap[r.parentNode.id][D]+=1,r.isLeaf&&(this.localSearch.countMap[r.parentNode.id][R]+=1))),(r.isMatched||r.isBranch&&r.isExpandedOnSearch)&&r.parentNode!==E&&(r.parentNode.isExpandedOnSearch=!0,r.parentNode.hasMatchedDescendants=!0)}),t()},handleRemoteSearch(){const{searchQuery:e}=this.trigger,t=this.getRemoteSearchEntry(),s=()=>{this.initialize(),this.resetHighlightedOptionWhenNecessary(!0)};if((e===""||this.cacheOptions)&&t.isLoaded)return s();this.callLoadOptionsProp({action:Os,args:{searchQuery:e},isPending(){return t.isLoading},start:()=>{t.isLoading=!0,t.isLoaded=!1,t.loadingError=""},succeed:n=>{t.isLoaded=!0,t.options=n,this.trigger.searchQuery===e&&s()},fail:n=>{t.loadingError=Y(n)},end:()=>{t.isLoading=!1}})},getRemoteSearchEntry(){const{searchQuery:e}=this.trigger,t=this.remoteSearch[e]||{...q(),options:[]};if(this.$watch(()=>t.options,()=>{this.trigger.searchQuery===e&&this.initialize()},{deep:!0}),e===""){if(Array.isArray(this.defaultOptions))return t.options=this.defaultOptions,t.isLoaded=!0,t;if(this.defaultOptions!==!0)return t.isLoaded=!0,t}return this.remoteSearch[e]||(this.remoteSearch[e]=t),t},shouldExpand(e){return this.localSearch.active?e.isExpandedOnSearch:e.isExpanded},shouldOptionBeIncludedInSearchResult(e){return!!(e.isMatched||e.isBranch&&e.hasMatchedDescendants&&!this.flattenSearchResults||!e.isRootNode&&e.parentNode.showAllChildrenOnSearch)},shouldShowOptionInMenu(e){return!(this.localSearch.active&&!this.shouldOptionBeIncludedInSearchResult(e))},getControl(){var e;return(e=this.$refs.control)==null?void 0:e.$el},getMenu(){var t,s;const e=(s=(t=this.$refs.menu)==null?void 0:t.$refs)==null?void 0:s.menu;return e&&e.nodeName!=="#comment"?e:null},setCurrentHighlightedOption(e,t=!0){const s=this.menu.current;if(s!=null&&s in this.forest.nodeMap&&(this.forest.nodeMap[s].isHighlighted=!1),this.menu.current=e.id,e.isHighlighted=!0,this.menu.isOpen&&t){const n=()=>{const r=this.getMenu(),o=r.querySelector(`.vue-treeselect__option[data-id="${e.id}"]`);o&&Pe(r,o)};this.getMenu()?n():this.$nextTick(n)}},resetHighlightedOptionWhenNecessary(e=!1){const{current:t}=this.menu;(e||t==null||!(t in this.forest.nodeMap)||!this.shouldShowOptionInMenu(this.getNode(t)))&&this.highlightFirstOption()},highlightFirstOption(){if(!this.hasVisibleOptions)return;const e=this.visibleOptionIds[0];this.setCurrentHighlightedOption(this.getNode(e))},highlightPrevOption(){if(!this.hasVisibleOptions)return;const e=this.visibleOptionIds.indexOf(this.menu.current)-1;if(e===-1)return this.highlightLastOption();this.setCurrentHighlightedOption(this.getNode(this.visibleOptionIds[e]))},highlightNextOption(){if(!this.hasVisibleOptions)return;const e=this.visibleOptionIds.indexOf(this.menu.current)+1;if(e===this.visibleOptionIds.length)return this.highlightFirstOption();this.setCurrentHighlightedOption(this.getNode(this.visibleOptionIds[e]))},highlightLastOption(){if(!this.hasVisibleOptions)return;const e=pe(this.visibleOptionIds);this.setCurrentHighlightedOption(this.getNode(e))},resetSearchQuery(){this.trigger.searchQuery=""},closeMenu(){!this.menu.isOpen||!this.disabled&&this.alwaysOpen||(this.saveMenuScrollPosition(),this.menu.isOpen=!1,this.toggleClickOutsideEvent(!1),this.resetSearchQuery(),this.$emit("close",this.getValue(),this.getInstanceId()))},openMenu(){this.disabled||this.menu.isOpen||(this.menu.isOpen=!0,this.$nextTick(this.resetHighlightedOptionWhenNecessary),this.$nextTick(this.restoreMenuScrollPosition),!this.options&&!this.async&&this.loadRootOptions(),this.toggleClickOutsideEvent(!0),this.$emit("open",this.getInstanceId()))},toggleMenu(){this.menu.isOpen?this.closeMenu():this.openMenu()},toggleExpanded(e){let t;this.localSearch.active?(t=e.isExpandedOnSearch=!e.isExpandedOnSearch,t&&(e.showAllChildrenOnSearch=!0)):t=e.isExpanded=!e.isExpanded,t&&!e.childrenStates.isLoaded&&this.loadChildrenOptions(e)},buildForestState(){const e=S();this.forest.selectedNodeIds.forEach(s=>{e[s]=!0}),this.forest.selectedNodeMap=e;const t=S();this.multiple&&(this.traverseAllNodesByIndex(s=>{t[s.id]=te}),this.selectedNodes.forEach(s=>{t[s.id]=xe,!this.flat&&!this.disableBranchNodes&&s.ancestors.forEach(n=>{this.isSelected(n)||(t[n.id]=Te)})})),this.forest.checkedStateMap=t},enhancedNormalizer(e){return{...e,...this.normalizer(e,this.getInstanceId())}},normalize(e,t,s){let n=t.map(r=>[this.enhancedNormalizer(r),r]).map(([r,o],l)=>{this.checkDuplication(r),this.verifyNodeShape(r);const{id:c,label:h,children:p,isDefaultExpanded:g}=r,f=e===E,v=f?0:e.level+1,_=Array.isArray(p)||p===null,T=!_,B=!!r.isDisabled||!this.flat&&!f&&e.isDisabled,$=!!r.isSelfDisabled,C=!!r.isNew,V=this.matchKeys.reduce((u,d)=>({...u,[d]:ws(r[d]).toLocaleLowerCase()}),{}),W=f?V.label:e.nestedSearchLabel+" "+V.label;this.forest.nodeMap[c]=S();const a=this.forest.nodeMap[c];if(a.id=c,a.label=h,a.level=v,a.ancestors=f?[]:[e].concat(e.ancestors),a.index=(f?[]:e.index).concat(l),a.parentNode=e,a.lowerCased=V,a.nestedSearchLabel=W,a.isDisabled=B,a.isSelfDisabled=$,a.isNew=C,a.isMatched=!1,a.isHighlighted=!1,a.isBranch=_,a.isLeaf=T,a.isRootNode=f,a.raw=o,_){const u=Array.isArray(p);a.childrenStates={...q(),isLoaded:u},a.isExpanded=typeof g=="boolean"?g:v<this.defaultExpandLevel,a.hasMatchedDescendants=!1,a.hasDisabledDescendants=!1,a.isExpandedOnSearch=!1,a.showAllChildrenOnSearch=!1,a.count={[D]:0,[I]:0,[R]:0,[A]:0},a.children=u?this.normalize(a,p,s):[],g===!0&&a.ancestors.forEach(d=>{d.isExpanded=!0}),!u&&typeof this.loadOptions!="function"?N(()=>!1,()=>'Unloaded branch node detected. "loadOptions" prop is required to load its children.'):!u&&a.isExpanded&&this.loadChildrenOptions(a)}if(a.ancestors.forEach(u=>u.count[I]++),T&&a.ancestors.forEach(u=>u.count[A]++),f||(e.count[D]+=1,T&&(e.count[R]+=1),B&&(e.hasDisabledDescendants=!0)),s&&s[c]){const u=s[c];a.isMatched=u.isMatched,a.showAllChildrenOnSearch=u.showAllChildrenOnSearch,a.isHighlighted=u.isHighlighted,u.isBranch&&a.isBranch&&(a.isExpanded=u.isExpanded,a.isExpandedOnSearch=u.isExpandedOnSearch,u.childrenStates.isLoaded&&!a.childrenStates.isLoaded?a.isExpanded=!1:a.childrenStates={...u.childrenStates})}return a});if(this.branchNodesFirst){const r=n.filter(l=>l.isBranch),o=n.filter(l=>l.isLeaf);n=r.concat(o)}return n},loadRootOptions(){this.callLoadOptionsProp({action:ys,isPending:()=>this.rootOptionsStates.isLoading,start:()=>{this.rootOptionsStates.isLoading=!0,this.rootOptionsStates.loadingError=""},succeed:()=>{this.rootOptionsStates.isLoaded=!0,this.$nextTick(()=>{this.resetHighlightedOptionWhenNecessary(!0)})},fail:e=>{this.rootOptionsStates.loadingError=Y(e)},end:()=>{this.rootOptionsStates.isLoading=!1}})},loadChildrenOptions(e){const{id:t,raw:s}=e;this.callLoadOptionsProp({action:Ns,args:{parentNode:s},isPending:()=>this.getNode(t).childrenStates.isLoading,start:()=>{this.getNode(t).childrenStates.isLoading=!0,this.getNode(t).childrenStates.loadingError=""},succeed:()=>{this.getNode(t).childrenStates.isLoaded=!0},fail:n=>{this.getNode(t).childrenStates.loadingError=Y(n)},end:()=>{this.getNode(t).childrenStates.isLoading=!1}})},callLoadOptionsProp({action:e,args:t,isPending:s,start:n,succeed:r,fail:o,end:l}){if(!this.loadOptions||s())return;n();const c=ds((p,g)=>{p?o(p):r(g),l()}),h=this.loadOptions({id:this.getInstanceId(),instanceId:this.getInstanceId(),action:e,...t,callback:c});Ve(h)&&h.then(()=>{c()},p=>{c(p)}).catch(p=>{console.error(p)})},checkDuplication(e){N(()=>!(e.id in this.forest.nodeMap&&!this.forest.nodeMap[e.id].isFallbackNode),()=>`Detected duplicate presence of node id ${JSON.stringify(e.id)}. Their labels are "${this.forest.nodeMap[e.id].label}" and "${e.label}" respectively.`)},verifyNodeShape(e){N(()=>!(e.children===void 0&&e.isBranch===!0),()=>"Are you meant to declare an unloaded branch node? `isBranch: true` is no longer supported, please use `children: null` instead.")},select(e){if(this.disabled||e.isDisabled||e.isSelfDisabled)return;this.single&&this.clear();const t=this.multiple&&!this.flat?this.forest.checkedStateMap[e.id]===te:!this.isSelected(e);t?this._selectNode(e):this._deselectNode(e),this.buildForestState(),t?this.$emit("select",e.raw,this.getInstanceId()):this.$emit("deselect",e.raw,this.getInstanceId()),this.localSearch.active&&t&&(this.single||this.clearOnSelect)&&this.resetSearchQuery(),this.single&&this.closeOnSelect&&(this.closeMenu(),this.searchable&&(this._blurOnSelect=!0))},clear(){this.hasValue&&(this.single||this.allowClearingDisabled?this.forest.selectedNodeIds=[]:this.forest.selectedNodeIds=this.forest.selectedNodeIds.filter(e=>this.getNode(e).isDisabled||this.getNode(e).isSelfDisabled),this.buildForestState())},_selectNode(e){if(this.single||this.disableBranchNodes)return this.addValue(e);if(this.flat){this.addValue(e),this.autoSelectAncestors?e.ancestors.forEach(s=>{!this.isSelected(s)&&!s.isDisabled&&!s.isSelfDisabled&&this.addValue(s)}):this.autoSelectDescendants&&this.traverseDescendantsBFS(e,s=>{!this.isSelected(s)&&!s.isDisabled&&!s.isSelfDisabled&&this.addValue(s)});return}const t=e.isLeaf||!e.hasDisabledDescendants||this.allowSelectingDisabledDescendants;if(t&&this.addValue(e),e.isBranch&&this.traverseDescendantsBFS(e,s=>{(!s.isDisabled||!s.isSelfDisabled||this.allowSelectingDisabledDescendants)&&this.addValue(s)}),t){let s=e;for(;(s=s.parentNode)!==E&&s.children.every(this.isSelected);)this.addValue(s)}},_deselectNode(e){if(this.disableBranchNodes)return this.removeValue(e);if(this.flat){this.removeValue(e),this.autoDeselectAncestors?e.ancestors.forEach(s=>{this.isSelected(s)&&!s.isDisabled&&!s.isSelfDisabled&&this.removeValue(s)}):this.autoDeselectDescendants&&this.traverseDescendantsBFS(e,s=>{this.isSelected(s)&&!s.isDisabled&&!s.isSelfDisabled&&this.removeValue(s)});return}let t=!1;if(e.isBranch&&this.traverseDescendantsDFS(e,s=>{(!s.isDisabled||!s.isSelfDisabled||this.allowSelectingDisabledDescendants)&&(this.removeValue(s),t=!0)}),e.isLeaf||t||e.children.length===0){this.removeValue(e);let s=e;for(;(s=s.parentNode)!==E&&this.isSelected(s);)this.removeValue(s)}},addValue(e){this.forest.selectedNodeIds.push(e.id),this.forest.selectedNodeMap[e.id]=!0},removeValue(e){we(this.forest.selectedNodeIds,e.id),delete this.forest.selectedNodeMap[e.id]},removeLastValue(){if(!this.hasValue)return;if(this.single)return this.clear();const e=pe(this.internalValue),t=this.getNode(e);this.select(t)},saveMenuScrollPosition(){const e=this.getMenu();e&&(this.menu.lastScrollPosition=e.scrollTop)},restoreMenuScrollPosition(){const e=this.getMenu();e&&(e.scrollTop=this.menu.lastScrollPosition)}},created(){this.verifyProps(),this.resetFlags()},mounted(){this.autoFocus&&this.focusInput(),!this.options&&!this.async&&this.autoLoadRootOptions&&this.loadRootOptions(),this.alwaysOpen&&this.openMenu(),this.async&&this.defaultOptions&&this.handleRemoteSearch()},unmounted(){this.toggleClickOutsideEvent(!1)}};function Vs(e){return typeof e=="string"?e:e!=null&&!Ce(e)?JSON.stringify(e):""}const Ds={name:"vue-treeselect--hidden-fields",inject:["instance"],render(){const{instance:e}=this;if(!e||!("name"in e)||!e.name||e.disabled||!e.hasValue)return null;let t=e.internalValue.map(Vs);return e.multiple&&e.joinValues&&(t=[t.join(e.delimiter)]),t.map((s,n)=>i.createVNode("input",{type:"hidden",name:e.name,value:s,key:"hidden-field-"+n},null))}},Ts=[m.ENTER,m.END,m.HOME,m.ARROW_LEFT,m.ARROW_UP,m.ARROW_RIGHT,m.ARROW_DOWN],Ie={name:"vue-treeselect--input",inject:["instance"],data:()=>({inputWidth:ve,value:""}),computed:{needAutoSize(){const{instance:e}=this;return e.searchable&&!e.disabled&&e.multiple},inputStyle(){return{width:this.needAutoSize?`${this.inputWidth}px`:null}}},watch:{"instance.trigger.searchQuery"(e){this.value=e},value(){this.needAutoSize&&this.$nextTick(this.updateInputWidth)}},created(){this.debouncedCallback=Wt(this.updateSearchQuery,_s,{leading:!0,trailing:!0})},methods:{clear(){this.onInput({target:{value:""}})},focus(){const{instance:e}=this;e.disabled||this.$refs.input&&this.$refs.input.focus()},blur(){this.$refs.input&&this.$refs.input.blur()},onFocus(){const{instance:e}=this;e.trigger.isFocused=!0,e.openOnFocus&&e.openMenu()},onBlur(){const{instance:e}=this,t=e.getMenu();if(t&&document.activeElement===t)return this.focus();e.trigger.isFocused=!1,e.closeMenu()},onInput(e){const{value:t}=e.target;this.value=t,t?this.debouncedCallback():(this.debouncedCallback.cancel(),this.updateSearchQuery())},onKeyDown(e){const{instance:t}=this,s="which"in e?e.which:e.keyCode;if(!(e.ctrlKey||e.shiftKey||e.altKey||e.metaKey)){if(!t.menu.isOpen&&O(Ts,s))return e.preventDefault(),t.openMenu();switch(s){case m.BACKSPACE:{t.backspaceRemoves&&!this.value.length&&t.removeLastValue();break}case m.ENTER:{if(e.preventDefault(),t.menu.current===null)return;const n=t.getNode(t.menu.current);if(n.isBranch&&t.disableBranchNodes)return;t.select(n);break}case m.ESCAPE:{this.value.length?this.clear():t.menu.isOpen&&t.closeMenu();break}case m.END:{e.preventDefault(),t.highlightLastOption();break}case m.HOME:{e.preventDefault(),t.highlightFirstOption();break}case m.ARROW_LEFT:{const n=t.getNode(t.menu.current);n.isBranch&&t.shouldExpand(n)?(e.preventDefault(),t.toggleExpanded(n)):!n.isRootNode&&(n.isLeaf||n.isBranch&&!t.shouldExpand(n))&&(e.preventDefault(),t.setCurrentHighlightedOption(n.parentNode));break}case m.ARROW_UP:{e.preventDefault(),t.highlightPrevOption();break}case m.ARROW_RIGHT:{const n=t.getNode(t.menu.current);n.isBranch&&!t.shouldExpand(n)&&(e.preventDefault(),t.toggleExpanded(n));break}case m.ARROW_DOWN:{e.preventDefault(),t.highlightNextOption();break}case m.DELETE:{t.deleteRemoves&&!this.value.length&&t.removeLastValue();break}default:t.openMenu()}}},onMouseDown(e){this.value.length&&e.stopPropagation()},renderInputContainer(){const{instance:e}=this,t={},s=[];return e.searchable&&!e.disabled&&(s.push(this.renderInput()),this.needAutoSize&&s.push(this.renderSizer())),e.searchable||ee(t,{on:{focus:this.onFocus,blur:this.onBlur,keydown:this.onKeyDown},ref:"input"}),!e.searchable&&!e.disabled&&ee(t,{attrs:{tabIndex:e.tabIndex}}),i.createVNode("div",i.mergeProps({class:"vue-treeselect__input-container"},t),[s])},renderInput(){const{instance:e}=this;return i.createVNode("input",{ref:"input",class:"vue-treeselect__input",type:"text",autocomplete:"off",tabIndex:e.tabIndex,required:e.required&&!e.hasValue,value:this.value,style:this.inputStyle,onFocus:this.onFocus,onInput:this.onInput,onBlur:this.onBlur,onKeydown:this.onKeyDown,onMousedown:this.onMouseDown},null)},renderSizer(){return i.createVNode("div",{ref:"sizer",class:"vue-treeselect__sizer"},[this.value])},updateInputWidth(){this.inputWidth=Math.max(ve,this.$refs.sizer.scrollWidth+15)},updateSearchQuery(){const{instance:e}=this;e.trigger.searchQuery=this.value}},render(){return this.renderInputContainer()}},Re={name:"vue-treeselect--placeholder",inject:["instance"],render(){const{instance:e}=this,t={"vue-treeselect__placeholder":!0,"vue-treeselect-helper-zoom-effect-off":!0,"vue-treeselect-helper-hide":e.hasValue||e.trigger.searchQuery};return i.createVNode("div",{class:t},[e.placeholder])}},xs={name:"vue-treeselect--single-value",inject:["instance"],methods:{renderSingleValueLabel(){const{instance:e}=this,t=e.selectedNodes[0],s=e.$slots["value-label"];return s?s({node:t}):t.label}},render(){const{instance:e,$parent:{renderValueContainer:t}}=this,s=e.hasValue&&!e.trigger.searchQuery;return t([s&&i.createVNode("div",{class:"vue-treeselect__single-value"},[this.renderSingleValueLabel()]),i.createVNode(Re,null,null),i.createVNode(Ie,{ref:"input"},null)])}},H=(e,t)=>{const s=e.__vccOpts||e;for(const[n,r]of t)s[n]=r;return s},Ms={name:"vue-treeselect--x"},Is={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 348.333 348.333"},Rs=i.createElementVNode("path",{d:"M336.559 68.611L231.016 174.165l105.543 105.549c15.699 15.705 15.699 41.145 0 56.85-7.844 7.844-18.128 11.769-28.407 11.769-10.296 0-20.581-3.919-28.419-11.769L174.167 231.003 68.609 336.563c-7.843 7.844-18.128 11.769-28.416 11.769-10.285 0-20.563-3.919-28.413-11.769-15.699-15.698-15.699-41.139 0-56.85l105.54-105.549L11.774 68.611c-15.699-15.699-15.699-41.145 0-56.844 15.696-15.687 41.127-15.687 56.829 0l105.563 105.554L279.721 11.767c15.705-15.687 41.139-15.687 56.832 0 15.705 15.699 15.705 41.145.006 56.844z"},null,-1),As=[Rs];function Bs(e,t,s,n,r,o){return i.openBlock(),i.createElementBlock("svg",Is,As)}const Ae=H(Ms,[["render",Bs]]),$s={name:"vue-treeselect--multi-value-item",inject:["instance"],props:{node:{type:Object,required:!0}},methods:{handleMouseDown:w(function(){const{instance:t,node:s}=this;t.select(s)})},render(){const{instance:e,node:t}=this,s={"vue-treeselect__multi-value-item":!0,"vue-treeselect__multi-value-item-disabled":t.isDisabled||t.isSelfDisabled,"vue-treeselect__multi-value-item-new":t.isNew},n=e.$slots["value-label"],r=n?n({node:t}):t.label;return i.createVNode("div",{class:"vue-treeselect__multi-value-item-container"},[i.createVNode("div",{class:s,onMousedown:this.handleMouseDown},[i.createVNode("span",{class:"vue-treeselect__multi-value-label"},[r]),i.createVNode("span",{class:"vue-treeselect__icon vue-treeselect__value-remove"},[i.createVNode(Ae,null,null)])])])}},ks={name:"vue-treeselect--multi-value",inject:["instance"],methods:{renderMultiValueItems(){const{instance:e}=this;return e.internalValue.slice(0,e.limit).map(e.getNode).map(t=>i.createVNode($s,{key:`multi-value-item-${t.id}`,node:t},null))},renderExceedLimitTip(){const{instance:e}=this,t=e.internalValue.length-e.limit;return t<=0?null:i.createVNode("div",{class:"vue-treeselect__limit-tip vue-treeselect-helper-zoom-effect-off",key:"exceed-limit-tip"},[i.createVNode("span",{class:"vue-treeselect__limit-tip-text"},[e.limitText(t)])])}},render(){const{renderValueContainer:e}=this.$parent;return e(i.createVNode("div",{class:"vue-treeselect__multi-value",name:"vue-treeselect__multi-value-item--transition"},[this.renderMultiValueItems(),this.renderExceedLimitTip(),i.createVNode(Re,{key:"placeholder"},null),i.createVNode(Ie,{ref:"input",key:"input"},null)]))}},zs={name:"vue-treeselect--arrow"},Fs={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 292.362 292.362"},Hs=i.createElementVNode("path",{d:"M286.935 69.377c-3.614-3.617-7.898-5.424-12.848-5.424H18.274c-4.952 0-9.233 1.807-12.85 5.424C1.807 72.998 0 77.279 0 82.228c0 4.948 1.807 9.229 5.424 12.847l127.907 127.907c3.621 3.617 7.902 5.428 12.85 5.428s9.233-1.811 12.847-5.428L286.935 95.074c3.613-3.617 5.427-7.898 5.427-12.847 0-4.948-1.814-9.229-5.427-12.85z"},null,-1),Ws=[Hs];function Ps(e,t,s,n,r,o){return i.openBlock(),i.createElementBlock("svg",Fs,Ws)}const Be=H(zs,[["render",Ps]]),js={name:"vue-treeselect--control",inject:["instance"],computed:{shouldShowX(){const{instance:e}=this;return e.clearable&&!e.disabled&&e.hasValue&&(this.hasUndisabledValue||e.allowClearingDisabled)},shouldShowArrow(){const{instance:e}=this;return e.alwaysOpen?!e.menu.isOpen:!0},hasUndisabledValue(){const{instance:e}=this;return e.hasValue&&e.internalValue.some(t=>!e.getNode(t).isDisabled||!e.getNode(t).isSelfDisabled)}},methods:{renderX(){const{instance:e}=this,t=e.multiple?e.clearAllText:e.clearValueText;return this.shouldShowX?i.createVNode("div",{class:"vue-treeselect__x-container",title:t,onMousedown:this.handleMouseDownOnX},[i.createVNode(Ae,{class:"vue-treeselect__x"},null)]):null},renderArrow(){const{instance:e}=this,t={"vue-treeselect__control-arrow":!0,"vue-treeselect__control-arrow--rotated":e.menu.isOpen};return this.shouldShowArrow?i.createVNode("div",{class:"vue-treeselect__control-arrow-container",onMousedown:this.handleMouseDownOnArrow},[i.createVNode(Be,{class:t},null)]):null},handleMouseDownOnX:w(function(t){t.stopPropagation(),t.preventDefault();const{instance:s}=this,n=s.beforeClearAll(),r=o=>{o&&s.clear()};Ve(n)?n.then(r):setTimeout(()=>r(n),0)}),handleMouseDownOnArrow:w(function(t){t.preventDefault(),t.stopPropagation();const{instance:s}=this;s.focusInput(),s.toggleMenu()}),renderValueContainer(e){return i.createVNode("div",{class:"vue-treeselect__value-container"},[e])}},render(){const{instance:e}=this,t=e.single?xs:ks;return i.createVNode("div",{class:"vue-treeselect__control",onMousedown:e.handleMouseDown},[i.createVNode(t,{ref:"value-container"},null),this.renderX(),this.renderArrow()])}},b={name:"vue-treeselect--tip",props:{type:{type:String,required:!0},icon:{type:String,required:!0}},render(){const{type:e,icon:t}=this;return i.createVNode("div",{class:`vue-treeselect__tip vue-treeselect__${e}-tip`},[i.createVNode("div",{class:"vue-treeselect__icon-container"},[i.createVNode("span",{class:`vue-treeselect__icon-${t}`},null)]),i.createVNode("span",{class:`vue-treeselect__tip-text vue-treeselect__${e}-tip-text`},[this.$slots.default()])])}};let X,G,J;const Qs={name:"vue-treeselect--option",inject:["instance"],props:{node:{type:Object,required:!0}},computed:{shouldExpand(){const{instance:e,node:t}=this;return t.isBranch&&e.shouldExpand(t)},shouldShow(){const{instance:e,node:t}=this;return e.shouldShowOptionInMenu(t)}},methods:{renderOption(){const{instance:e,node:t}=this,s={"vue-treeselect__option":!0,"vue-treeselect__option--disabled":t.isDisabled||t.isSelfDisabled,"vue-treeselect__option--selected":e.isSelected(t),"vue-treeselect__option--highlight":t.isHighlighted,"vue-treeselect__option--matched":e.localSearch.active&&t.isMatched,"vue-treeselect__option--hide":!this.shouldShow};return i.createVNode("div",{class:s,onMouseenter:this.handleMouseEnterOption,"data-id":t.id},[this.renderArrow(),this.renderLabelContainer([this.renderCheckboxContainer([this.renderCheckbox()]),this.renderLabel()])])},renderSubOptionsList(){return this.shouldExpand?i.createVNode("div",{class:"vue-treeselect__list"},[this.renderSubOptions(),this.renderNoChildrenTip(),this.renderLoadingChildrenTip(),this.renderLoadingChildrenErrorTip()]):null},renderArrow(){const{instance:e,node:t}=this;if(e.shouldFlattenOptions&&this.shouldShow)return null;if(t.isBranch){const s={"vue-treeselect__option-arrow":!0,"vue-treeselect__option-arrow--rotated":this.shouldExpand};return i.createVNode("div",{class:"vue-treeselect__option-arrow-container",onMousedown:this.handleMouseDownOnArrow},[i.createVNode("div",{name:"vue-treeselect__option-arrow--prepare"},[i.createVNode(Be,{class:s},null)])])}return e.hasBranchNodes?(X||(X=i.createVNode("div",{class:"vue-treeselect__option-arrow-placeholder"},[i.createTextVNode("Â ")])),X):null},renderLabelContainer(e){return i.createVNode("div",{class:"vue-treeselect__label-container",onMousedown:this.handleMouseDownOnLabelContainer},[e])},renderCheckboxContainer(e){const{instance:t,node:s}=this;return t.single||t.disableBranchNodes&&s.isBranch?null:i.createVNode("div",{class:"vue-treeselect__checkbox-container"},[e])},renderCheckbox(){const{instance:e,node:t}=this,s=e.forest.checkedStateMap[t.id],n={"vue-treeselect__checkbox":!0,"vue-treeselect__checkbox--checked":s===xe,"vue-treeselect__checkbox--indeterminate":s===Te,"vue-treeselect__checkbox--unchecked":s===te,"vue-treeselect__checkbox--disabled":t.isDisabled||t.isSelfDisabled};return G||(G=i.createVNode("span",{class:"vue-treeselect__check-mark"},null)),J||(J=i.createVNode("span",{class:"vue-treeselect__minus-mark"},null)),i.createVNode("span",{class:n},[G,J])},renderLabel(){const{instance:e,node:t}=this,s=t.isBranch&&(e.localSearch.active?e.showCountOnSearchComputed:e.showCount),n=s?e.localSearch.active?e.localSearch.countMap[t.id][e.showCountOf]:t.count[e.showCountOf]:NaN,r="vue-treeselect__label",o="vue-treeselect__count",l=e.$slots["option-label"];return l?l({node:t,shouldShowCount:s,count:n,labelClassName:r,countClassName:o}):i.createVNode("label",{class:r},[t.label,s&&i.createVNode("span",{class:o},[i.createTextVNode("("),n,i.createTextVNode(")")])])},renderSubOptions(){const{node:e}=this;return e.childrenStates.isLoaded?e.children.map(t=>i.createVNode(i.resolveComponent("vue-treeselect--option"),{node:t,key:t.id},null)):null},renderNoChildrenTip(){const{instance:e,node:t}=this;return!t.childrenStates.isLoaded||t.children.length?null:i.createVNode(b,{type:"no-children",icon:"warning"},{default:()=>[e.noChildrenText]})},renderLoadingChildrenTip(){const{instance:e,node:t}=this;return t.childrenStates.isLoading?i.createVNode(b,{type:"loading",icon:"loader"},{default:()=>[e.loadingText]}):null},renderLoadingChildrenErrorTip(){const{instance:e,node:t}=this;return t.childrenStates.loadingError?i.createVNode(b,{type:"error",icon:"error"},{default:()=>[t.childrenStates.loadingError,i.createVNode("a",{class:"vue-treeselect__retry",title:e.retryTitle,onMousedown:this.handleMouseDownOnRetry},[e.retryText])]}):null},handleMouseEnterOption(e){const{instance:t,node:s}=this;e.target===e.currentTarget&&t.setCurrentHighlightedOption(s,!1)},handleMouseDownOnArrow:w(function(){const{instance:t,node:s}=this;t.toggleExpanded(s)}),handleMouseDownOnLabelContainer:w(function(){const{instance:t,node:s}=this;s.isBranch&&t.disableBranchNodes?t.toggleExpanded(s):t.select(s)}),handleMouseDownOnRetry:w(function(){const{instance:t,node:s}=this;t.loadChildrenOptions(s)})},render(){const{node:e}=this,s={"vue-treeselect__list-item":!0,[`vue-treeselect__indent-level-${this.instance.shouldFlattenOptions?0:e.level}`]:!0};return i.createVNode("div",{class:s},[this.renderOption(),e.isBranch?i.createVNode("div",null,[this.renderSubOptionsList()]):""])}},Us={top:"top",bottom:"bottom",above:"top",below:"bottom"},Ks={name:"vue-treeselect--menu",inject:["instance"],data(){return{controlResizeAndScrollEventListeners:null,controlSizeWatcher:null,menuSizeWatcher:null,menuResizeAndScrollEventListeners:null}},computed:{classes(){let e={"vue-treeselect__menu-container":!0};return this.instance.appendToBody&&(e["vue-treeselect__portal-target"]=!0),e},menuStyle(){const{instance:e}=this;return{maxHeight:e.maxHeight+"px"}},menuContainerStyle(){const{instance:e}=this;return{zIndex:e.appendToBody?null:e.zIndex}}},watch:{"instance.menu.placement"(){this.instance.appendToBody&&this.updateMenuContainerOffset()},"instance.menu.isOpen":{handler(e){e?(this.$nextTick(this.onMenuOpen),this.instance.appendToBody&&this.setupHandlers()):(this.onMenuClose(),this.instance.appendToBody&&this.removeHandlers())},immediate:!0}},created(){this.menuSizeWatcher=null,this.menuResizeAndScrollEventListeners=null},mounted(){},unmounted(){this.onMenuClose(),this.instance.appendToBody&&this.removeHandlers()},methods:{renderMenu(){const{instance:e}=this;return e.menu.isOpen?i.createVNode("div",{ref:"menu",class:"vue-treeselect__menu",onMousedown:e.handleMouseDown,style:this.menuStyle},[this.renderBeforeList(),e.async?this.renderAsyncSearchMenuInner():e.localSearch.active?this.renderLocalSearchMenuInner():this.renderNormalMenuInner(),this.renderAfterList()]):null},renderBeforeList(){const{instance:e}=this,t=e.$slots["before-list"];return t?t():null},renderAfterList(){const{instance:e}=this,t=e.$slots["after-list"];return t?t():null},renderNormalMenuInner(){const{instance:e}=this;return e.rootOptionsStates.isLoading?this.renderLoadingOptionsTip():e.rootOptionsStates.loadingError?this.renderLoadingRootOptionsErrorTip():e.rootOptionsStates.isLoaded&&e.forest.normalizedOptions.length===0?this.renderNoAvailableOptionsTip():this.renderOptionList()},renderLocalSearchMenuInner(){const{instance:e}=this;return e.rootOptionsStates.isLoading?this.renderLoadingOptionsTip():e.rootOptionsStates.loadingError?this.renderLoadingRootOptionsErrorTip():e.rootOptionsStates.isLoaded&&e.forest.normalizedOptions.length===0?this.renderNoAvailableOptionsTip():e.localSearch.noResults?this.renderNoResultsTip():this.renderOptionList()},renderAsyncSearchMenuInner(){const{instance:e}=this,t=e.getRemoteSearchEntry(),s=e.trigger.searchQuery===""&&!e.defaultOptions,n=s?!1:t.isLoaded&&t.options.length===0;return s?this.renderSearchPromptTip():t.isLoading?this.renderLoadingOptionsTip():t.loadingError?this.renderAsyncSearchLoadingErrorTip():n?this.renderNoResultsTip():this.renderOptionList()},renderOptionList(){const{instance:e}=this;return i.createVNode("div",{class:"vue-treeselect__list"},[e.forest.normalizedOptions.map(t=>i.createVNode(Qs,{node:t,key:t.id},null))])},renderSearchPromptTip(){const{instance:e}=this;return i.createVNode(b,{type:"search-prompt",icon:"warning"},{default:()=>[e.searchPromptText]})},renderLoadingOptionsTip(){const{instance:e}=this;return i.createVNode(b,{type:"loading",icon:"loader"},{default:()=>[e.loadingText]})},renderLoadingRootOptionsErrorTip(){const{instance:e}=this;return i.createVNode(b,{type:"error",icon:"error"},{default:()=>[e.rootOptionsStates.loadingError,i.createVNode("a",{class:"vue-treeselect__retry",onClick:e.loadRootOptions,title:e.retryTitle},[e.retryText])]})},renderAsyncSearchLoadingErrorTip(){const{instance:e}=this,t=e.getRemoteSearchEntry();return i.createVNode(b,{type:"error",icon:"error"},{default:()=>[t.loadingError,i.createVNode("a",{class:"vue-treeselect__retry",onClick:e.handleRemoteSearch,title:e.retryTitle},[e.retryText])]})},renderNoAvailableOptionsTip(){const{instance:e}=this;return i.createVNode(b,{type:"no-options",icon:"warning"},{default:()=>[e.noOptionsText]})},renderNoResultsTip(){const{instance:e}=this;return i.createVNode(b,{type:"no-results",icon:"warning"},{default:()=>[e.noResultsText]})},onMenuOpen(){this.adjustMenuOpenDirection(),this.setupMenuSizeWatcher(),this.setupMenuResizeAndScrollEventListeners(),this.instance.appendToBody&&this.updateMenuContainerOffset()},onMenuClose(){this.removeMenuSizeWatcher(),this.removeMenuResizeAndScrollEventListeners()},adjustMenuOpenDirection(){const{instance:e}=this;if(!e.menu.isOpen)return;const t=e.getMenu(),s=e.getControl(),n=t.getBoundingClientRect(),r=s.getBoundingClientRect(),o=n.height,l=window.innerHeight,c=r.top,h=window.innerHeight-r.bottom,p=r.top>=0&&r.top<=l||r.top<0&&r.bottom>0,g=h>o+Se,f=c>o+Se;p?e.openDirection!=="auto"?e.menu.placement=Us[e.openDirection]:g||!f?e.menu.placement="bottom":e.menu.placement="top":e.closeMenu()},setupMenuSizeWatcher(){const{instance:e}=this,t=e.getMenu();this.menuSizeWatcher||(this.menuSizeWatcher={remove:ce(t,this.adjustMenuOpenDirection)})},setupMenuResizeAndScrollEventListeners(){const{instance:e}=this,t=e.getControl();this.menuResizeAndScrollEventListeners||(this.menuResizeAndScrollEventListeners={remove:de(t,this.adjustMenuOpenDirection)})},removeMenuSizeWatcher(){this.menuSizeWatcher&&(this.menuSizeWatcher.remove(),this.menuSizeWatcher=null)},removeMenuResizeAndScrollEventListeners(){this.menuResizeAndScrollEventListeners&&(this.menuResizeAndScrollEventListeners.remove(),this.menuResizeAndScrollEventListeners=null)},setupHandlers(){this.updateWidth(),this.updateMenuContainerOffset(),this.setupControlResizeAndScrollEventListeners(),this.setupControlSizeWatcher()},removeHandlers(){this.removeControlResizeAndScrollEventListeners(),this.removeControlSizeWatcher()},setupControlResizeAndScrollEventListeners(){const{instance:e}=this,t=e.getControl();this.controlResizeAndScrollEventListeners||(this.controlResizeAndScrollEventListeners={remove:de(t,this.updateMenuContainerOffset)})},setupControlSizeWatcher(){const{instance:e}=this,t=e.getControl();this.controlSizeWatcher||(this.controlSizeWatcher={remove:ce(t,()=>{this.updateWidth(),this.updateMenuContainerOffset()})})},removeControlResizeAndScrollEventListeners(){this.controlResizeAndScrollEventListeners&&(this.controlResizeAndScrollEventListeners.remove(),this.controlResizeAndScrollEventListeners=null)},removeControlSizeWatcher(){this.controlSizeWatcher&&(this.controlSizeWatcher.remove(),this.controlSizeWatcher=null)},updateWidth(){const{instance:e}=this,t=this.$el,n=e.getControl().getBoundingClientRect();t&&(t.style.width=n.width+"px")},updateMenuContainerOffset(){const{instance:e}=this,t=e.getControl();if(t){const s=t.getBoundingClientRect(),n=Math.round(s.left)+"px",r=Math.round(s.bottom+window.scrollY)+"px",o=this.$refs["menu-container"].style;o.top=r,o.left=n}}},render(){return i.createVNode("div",{ref:"menu-container",class:this.classes,style:this.menuContainerStyle},[i.createVNode("div",{name:"vue-treeselect__menu--transition"},[this.renderMenu()])])}},qs=i.defineComponent({name:"vue-treeselect",mixins:[Cs],components:{HiddenFields:Ds,Control:js,Menu:Ks},computed:{wrapperClass(){return{"vue-treeselect":!0,"vue-treeselect--single":this.single,"vue-treeselect--multi":this.multiple,"vue-treeselect--searchable":this.searchable,"vue-treeselect--disabled":this.disabled,"vue-treeselect--focused":this.trigger.isFocused,"vue-treeselect--has-value":this.hasValue,"vue-treeselect--open":this.menu.isOpen,"vue-treeselect--open-above":this.menu.placement==="top","vue-treeselect--open-below":this.menu.placement==="bottom","vue-treeselect--branch-nodes-disabled":this.disableBranchNodes,"vue-treeselect--append-to-body":this.appendToBody}}}});function Ys(e,t,s,n,r,o){const l=i.resolveComponent("HiddenFields"),c=i.resolveComponent("Control"),h=i.resolveComponent("Menu");return i.openBlock(),i.createElementBlock("div",{ref:"wrapper",class:i.normalizeClass(e.wrapperClass)},[i.createVNode(l),i.createVNode(c,{ref:"control"},null,512),(i.openBlock(),i.createBlock(i.Teleport,{disabled:!e.appendToBody,to:"body"},[i.createVNode(h,{ref:"menu"},null,512)],8,["disabled"]))],2)}const Xs=H(qs,[["render",Ys]]),Gs=i.defineComponent({setup(){let e=i.ref([2,1]),t=i.ref([]),s=i.ref([]),n=i.ref([]);return i.ref("0"),{treeData:i.reactive({label:"root",expand:!0,id:1,children:[{label:"child 1",id:2},{label:"child 2",id:3},{label:"subparent 1",id:4,expand:!1,children:[{label:"subchild 1",id:5},{label:"subchild 2",id:6,expand:!1,children:[{label:"subchild 11",id:7},{label:"subchild 11",id:8},{label:"subchild 11",id:9},{label:"subchild 11",id:10},{label:"subchild 11",id:11},{label:"subchild 11",id:12},{label:"subchild 11",id:13},{label:"subchild 11",id:14},{label:"subchild 11",id:15},{label:"subchild 22",id:16}]}]}]}),selected:e,selected2:t,selected3:s,selected4:n}}}),Js={style:{"margin-top":"100px","margin-left":"100px","max-width":"300px"}},Zs={style:{"margin-top":"100px","margin-left":"100px","max-width":"300px"}},en=i.createStaticVNode("<p>lorem ipsum dolor sit amet</p><p>lorem ipsum dolor sit amet</p><p>lorem ipsum dolor sit amet</p><p>lorem ipsum dolor sit amet</p><p>lorem ipsum dolor sit amet</p><p>lorem ipsum dolor sit amet</p><p>lorem ipsum dolor sit amet</p><p>lorem ipsum dolor sit amet</p><p>lorem ipsum dolor sit amet</p><p>lorem ipsum dolor sit amet</p><p>lorem ipsum dolor sit amet</p><p>lorem ipsum dolor sit amet</p><p>lorem ipsum dolor sit amet</p>",13),tn={style:{"margin-top":"100px","margin-left":"100px","max-width":"300px"}},sn=i.createElementVNode("p",null,"lorem ipsum dolor sit amet",-1),nn=i.createElementVNode("p",null,"lorem ipsum dolor sit amet",-1),rn=i.createElementVNode("p",null,"lorem ipsum dolor sit amet",-1),on=i.createElementVNode("p",null,"lorem ipsum dolor sit amet",-1),ln=i.createElementVNode("p",null,"lorem ipsum dolor sit amet",-1),an=i.createElementVNode("p",null,"lorem ipsum dolor sit amet",-1),cn=i.createElementVNode("p",null,"lorem ipsum dolor sit amet",-1);function dn(e,t,s,n,r,o){const l=i.resolveComponent("vue-treeselect");return i.openBlock(),i.createElementBlock("div",null,[i.createElementVNode("div",Js,[i.createVNode(l,{multiple:!0,options:[e.treeData],noResultsText:"No results...",placeholder:"Select items...",modelValue:e.selected,"onUpdate:modelValue":t[0]||(t[0]=c=>e.selected=c),appendToBody:!0,"default-expand-level":0,autoSelectDescendants:!0,autoDeselectDescendants:!0,flat:!0,searchable:!1,"show-count":!0},null,8,["options","modelValue"]),i.createTextVNode(" Not appended to body: "),i.createVNode(l,{multiple:!1,placement:"bottom",appendToBody:!1,options:[e.treeData],noResultsText:"No results...",placeholder:"Select items...",modelValue:e.selected4,"onUpdate:modelValue":t[1]||(t[1]=c=>e.selected4=c),"default-expand-level":0,autoSelectDescendants:!0,autoDeselectDescendants:!0,flat:!0,searchable:!1,"show-count":!0,"open-on-click":!0,"open-on-focus":!0,"clear-on-select":!0,isDefaultExpanded:!0,"always-open":!1,disabled:e.read_only,disableFuzzyMatching:!0,defaultExpandLevel:e.expandLevel,class:"tree-select","close-on-select":!0,maxHeight:250,"open-direction":"auto"},null,8,["options","modelValue","disabled","defaultExpandLevel"])]),i.createElementVNode("div",null," Selected: "+i.toDisplayString(e.selected),1),i.createTextVNode(" Append to body: "),i.createElementVNode("div",Zs,[i.createVNode(l,{multiple:!1,options:[e.treeData],placement:"top",noResultsText:"No results...",placeholder:"Select items...",modelValue:e.selected2,"onUpdate:modelValue":t[2]||(t[2]=c=>e.selected2=c),appendToBody:!0,"default-expand-level":0,autoSelectDescendants:!0,autoDeselectDescendants:!0,flat:!0,searchable:!1,"show-count":!0,"open-on-click":!0,"open-on-focus":!0,"clear-on-select":!0,isDefaultExpanded:!0,"always-open":!1,disableFuzzyMatching:!0,defaultExpandLevel:999,class:"tree-select","close-on-select":!1,maxHeight:250,"open-direction":"auto"},null,8,["options","modelValue"])]),en,i.createElementVNode("div",tn,[i.createVNode(l,{multiple:!0,options:[e.treeData],placement:"top",noResultsText:"No results...",placeholder:"Select items...",modelValue:e.selected3,"onUpdate:modelValue":t[3]||(t[3]=c=>e.selected3=c),appendToBody:!0,"default-expand-level":0,autoSelectDescendants:!0,autoDeselectDescendants:!0,flat:!0,searchable:!1,"show-count":!0,"open-on-click":!0,"open-on-focus":!0,"clear-on-select":!0,isDefaultExpanded:!0,"always-open":!1,disableFuzzyMatching:!0,defaultExpandLevel:999,class:"tree-select","close-on-select":!1,maxHeight:250,"open-direction":"auto"},null,8,["options","modelValue"])]),sn,nn,rn,on,ln,an,cn])}const un=H(Gs,[["render",dn]]);i.createApp(un).component("vue-treeselect",Xs).mount("#app");
